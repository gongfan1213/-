> ğŸ’­ å¥½çš„ï¼Œç°åœ¨æˆ‘è¦ä»”ç»†åˆ†æç”¨æˆ·çš„é—®é¢˜ï¼Œå¹¶æ€è€ƒå¦‚ä½•è§£å†³ä»–é‡åˆ°çš„é”™è¯¯ã€‚æ ¹æ®ç”¨æˆ·æä¾›çš„é”™è¯¯ä¿¡æ¯å’Œä¹‹å‰çš„å¯¹è¯å†å²ï¼Œé—®é¢˜å‡ºåœ¨æ—¶é—´æ•°æ®å¤„ç†å’Œå¯è§†åŒ–é˜¶æ®µã€‚ç”¨æˆ·ç°åœ¨ç»™å‡ºäº†ä¸€äº›è¡¨å¤´ï¼Œå…¶ä¸­åŒ…æ‹¬'title', 'time', 'content', 'link', 'cleaned_content', 'segmented', 'sentiment', 'quality_score', 'datetime'ï¼Œä½†æ²¡æœ‰å®é™…çš„æ—¶é—´æ•°æ®ã€‚
>
> é¦–å…ˆï¼Œæˆ‘éœ€è¦æ˜ç¡®é—®é¢˜çš„å…³é”®ç‚¹ï¼šç”¨æˆ·åœ¨è¿è¡Œæ—¶é—´åºåˆ—åˆ†ææ—¶é‡åˆ°äº†IndexErrorï¼Œå¯èƒ½æ˜¯å› ä¸ºæ•°æ®ä¸­çš„æ—¶é—´å­—æ®µæ— æ•ˆæˆ–ç¼ºå¤±ï¼Œå¯¼è‡´å¤„ç†åçš„DataFrameä¸ºç©ºï¼Œä»è€Œåœ¨å°è¯•ç»˜å›¾æ—¶å¤±è´¥ã€‚ç”¨æˆ·å·²ç»å°è¯•è¿‡ä½¿ç”¨pd.to_datetimeè½¬æ¢æ—¶é—´ï¼Œä½†ç”±äºé”™è¯¯å¤„ç†ä¸º'coerce'ï¼Œå¯¼è‡´å¾ˆå¤šNaTï¼Œè¿›è€Œè¿‡æ»¤åæ•°æ®å¯èƒ½ä¸ºç©ºã€‚
>
> ä¸‹ä¸€æ­¥ï¼Œæˆ‘éœ€è¦è§£å†³ç”¨æˆ·çš„é—®é¢˜ï¼Œå³åœ¨ç¼ºå°‘æœ‰æ•ˆæ—¶é—´æ•°æ®çš„æƒ…å†µä¸‹å¦‚ä½•è¿›è¡Œæ—¶é—´åºåˆ—åˆ†æï¼Œå¹¶é˜²æ­¢ç¨‹åºå´©æºƒã€‚å¯èƒ½çš„è§£å†³æ–¹æ¡ˆåŒ…æ‹¬ï¼š
>
> 1. **æ£€æŸ¥æ—¶é—´å­—æ®µçš„å­˜åœ¨å’Œæœ‰æ•ˆæ€§**ï¼šç”¨æˆ·çš„æ•°æ®ä¸­å­˜åœ¨'time'å’Œ'datetime'å­—æ®µï¼Œéœ€è¦ç¡®è®¤è¿™äº›å­—æ®µæ˜¯å¦åŒ…å«æœ‰æ•ˆçš„æ•°æ®ï¼Œæˆ–è€…æ˜¯å¦å…¨éƒ¨ä¸ºç¼ºå¤±å€¼ã€‚å¦‚æœä»…æœ‰å°‘é‡æœ‰æ•ˆæ•°æ®ï¼Œå¯èƒ½éœ€è¦è°ƒæ•´åˆ†ææ–¹æ³•ã€‚
>
> 2. **æ”¹è¿›æ—¶é—´è§£æçš„é²æ£’æ€§**ï¼šåœ¨è½¬æ¢æ—¶é—´å­—æ®µæ—¶ï¼Œä½¿ç”¨å¤šç§æ ¼å¼å°è¯•è§£æï¼Œå¹¶å¤„ç†å¯èƒ½çš„å¼‚å¸¸æƒ…å†µã€‚æ¯”å¦‚ï¼Œä½¿ç”¨å·²çŸ¥çš„æ—¥æœŸæ ¼å¼è¿›è¡Œå°è¯•ï¼Œå¦‚æœå‡å¤±è´¥ï¼Œåˆ™æ”¾å¼ƒæ—¶é—´åˆ†æéƒ¨åˆ†ï¼Œè€Œä¸æ˜¯è®©ç¨‹åºå´©æºƒã€‚
>
> 3. **æ·»åŠ æ•°æ®æœ‰æ•ˆæ€§æ£€æŸ¥**ï¼šåœ¨è¿›è¡Œæ—¶é—´ç›¸å…³çš„åˆ†æå’Œå¯è§†åŒ–ä¹‹å‰ï¼Œæ£€æŸ¥å¤„ç†åçš„DataFrameæ˜¯å¦ä¸ºç©ºã€‚å¦‚æœä¸ºç©ºï¼Œåˆ™è·³è¿‡ç›¸å…³æ­¥éª¤ï¼Œå¹¶ç»™å‡ºæç¤ºï¼Œé¿å…åç»­æ“ä½œå‡ºç°é”™è¯¯ã€‚
>
> 4. **ä¼˜åŒ–æŠ¥é”™ä¿¡æ¯å’Œæ—¥å¿—**ï¼šåœ¨å…³é”®æ­¥éª¤æ·»åŠ æ—¥å¿—è¾“å‡ºï¼Œå¸®åŠ©ç”¨æˆ·ç†è§£æ•°æ®å¤„ç†çš„çŠ¶æ€ï¼Œå°¤å…¶æ˜¯åœ¨æ—¶é—´è§£æå‡ºç°é—®é¢˜æ—¶æ˜ç¡®å‘ŠçŸ¥ç”¨æˆ·ã€‚
>
> 5. **æä¾›æ›¿ä»£åˆ†ææ–¹æ¡ˆ**ï¼šå¦‚æœæ—¶é—´æ•°æ®ä¸å¯ç”¨ï¼Œè€ƒè™‘è½¬å‘å…¶ä»–ç»´åº¦çš„åˆ†æï¼Œå¦‚åŸºäºå†…å®¹çš„åˆ†ææˆ–è€…æƒ…æ„Ÿå¾—åˆ†çš„åˆ†å¸ƒï¼Œè€Œéå¼ºåˆ¶ä¾èµ–æ—¶é—´åºåˆ—ã€‚
>
> æ ¹æ®ç”¨æˆ·æä¾›çš„å­—æ®µï¼Œæ¨æµ‹ç”¨æˆ·çš„DataFrameå¯èƒ½åŒ…å«ä¸€äº›æ—¶é—´å­—æ®µï¼ˆ'time'å’Œ'datetime'ï¼‰ï¼Œä½†å¯èƒ½å­˜åœ¨è§£æé—®é¢˜ã€‚ç”¨æˆ·éœ€è¦ä»£ç å³ä½¿åœ¨æ—¶é—´æ•°æ®æ— æ•ˆçš„æƒ…å†µä¸‹ä¹Ÿèƒ½ç»§ç»­è¿è¡Œå…¶ä»–åˆ†æï¼Œè€Œä¸æ˜¯æŠ›å‡ºé”™è¯¯ã€‚
>
> æ¥ä¸‹æ¥çš„è§£å†³æ–¹æ¡ˆéœ€è¦ï¼š
>
> - åœ¨æ—¶é—´è§£æé˜¶æ®µï¼Œæ·»åŠ è¯¦ç»†çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•ã€‚
>
> - åœ¨å¤„ç†æ—¶é—´æ•°æ®åï¼Œä¸¥æ ¼æ£€æŸ¥æ•°æ®æ˜¯å¦å­˜åœ¨æœ‰æ•ˆçš„è®°å½•ã€‚
>
> - å¦‚æœæ—¶é—´æ•°æ®ç¼ºå¤±æˆ–æ— æ•ˆï¼Œè·³è¿‡æ—¶é—´åºåˆ—åˆ†æå’Œç›¸å…³å¯è§†åŒ–ï¼Œä½†ç»§ç»­æ‰§è¡Œå…¶ä»–åˆ†ææ­¥éª¤ã€‚
>
> - ç¡®ä¿ä»£ç åœ¨0è¡Œæ—¶é—´æ•°æ®æ—¶ä¸ä¼šå°è¯•è®¿é—®ç©ºæ•°ç»„çš„ç´¢å¼•ï¼Œé˜²æ­¢IndexErrorã€‚
>
> å…·ä½“å®ç°æ—¶ï¼Œå¯ä»¥æ‹†åˆ†æ—¶é—´åˆ†æéƒ¨åˆ†ä¸ºç‹¬ç«‹å‡½æ•°ï¼Œå¹¶åœ¨è°ƒç”¨å‰æ·»åŠ æ¡ä»¶æ£€æŸ¥ã€‚ä¾‹å¦‚ï¼š
>
> ```python
>
> def analyze_time_data(df):
>
>     # å°è¯•è§£ææ—¶é—´å­—æ®µ
>
>     try:
>
>         # è½¬æ¢æ—¶é—´
>
>         time_series = pd.to_datetime(df['time'], format='æ··åˆ', errors='coerce')
>
>         df['datetime'] = time_series
>
>         valid_time_df = df[time_series.notna()]
>
>         if valid_time_df.empty:
>
>             print("æ— æœ‰æ•ˆæ—¶é—´æ•°æ®ï¼Œè·³è¿‡æ—¶é—´åˆ†æ")
>
>             return None
>
>         # æ‰§è¡Œæ—¶é—´åˆ†æå¹¶è¿”å›ç»“æœ
>
>         return valid_time_df
>
>     except Exception as e:
>
>         print(f"æ—¶é—´è§£æå¤±è´¥: {e}")
>
>         return None
>
> ```
>
> åœ¨ä¸»å‡½æ•°ä¸­ï¼Œé¦–å…ˆè°ƒç”¨è¯¥å‡½æ•°ï¼Œå¦‚æœè¿”å›Noneåˆ™è·³è¿‡ç›¸å…³éƒ¨åˆ†ï¼š
>
> ```python
>
> time_result = analyze_time_data(df)
>
> if time_result is not None:
>
>     # è¿›è¡Œæ—¶é—´åºåˆ—åˆ†æå’Œç»˜å›¾
>
> else:
>
>     # è·³è¿‡æ—¶é—´åˆ†æéƒ¨åˆ†
>
> ```
>
> æ­¤å¤–ï¼Œåœ¨å¯è§†åŒ–é˜¶æ®µï¼Œæ¯ä¸ªç»˜å›¾æ­¥éª¤å‰æ£€æŸ¥æ•°æ®æ˜¯å¦æœ‰æ•ˆï¼š
>
> ```python
>
> if not monthly_sentiment.empty:
>
>     monthly_sentiment.plot(kind='bar')
>
> else:
>
>     print("æ— æœ‰æ•ˆæœˆåº¦æ•°æ®è¿›è¡Œç»˜å›¾")
```
>
> è¿™æ ·å¯ä»¥ç¡®ä¿å³ä½¿æ²¡æœ‰æ—¶é—´æ•°æ®ï¼Œç¨‹åºä¹Ÿä¸ä¼šå´©æºƒï¼Œå¹¶ä¸”ç”¨æˆ·ä¼šæ”¶åˆ°æ˜ç¡®çš„æç¤ºï¼Œä¾¿äºåç»­è°ƒè¯•æˆ–è°ƒæ•´æ•°æ®å¤„ç†æµç¨‹ã€‚
>
> å¦ä¸€ä¸ªé—®é¢˜æ˜¯ç”¨æˆ·å¯èƒ½åœ¨æ•°æ®é¢„å¤„ç†é˜¶æ®µåˆ é™¤è¿‡å¤šçš„æ— æ•ˆæ—¶é—´è®°å½•ï¼Œå¯¼è‡´åç»­æ“ä½œæ— æ³•è¿›è¡Œã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨df = df[time_series.notna()]å¯èƒ½å°†æ•´ä¸ªDataFrameå˜ä¸ºç©ºã€‚æ­¤æ—¶åœ¨è¿›è¡Œåˆ†ç»„ç»Ÿè®¡æ—¶ä¼šå¤±è´¥ã€‚å› æ­¤ï¼Œåœ¨åˆ é™¤æ— æ•ˆæ—¶é—´è®°å½•ä¹‹å‰ï¼Œåº”è¯¥æ£€æŸ¥å‰©ä½™çš„æœ‰æ•ˆæ•°æ®é‡ï¼Œæˆ–åœ¨ä¹‹åçš„æ“ä½œä¸­æå‰å¤„ç†ç©ºæ•°æ®çš„æƒ…å†µã€‚
>
> æ€»ç»“è§£å†³æ–¹æ¡ˆæ­¥éª¤ï¼š
>
> 1. **å¤šé˜¶æ®µæ—¶é—´è§£æ**ï¼šä½¿ç”¨å¤šç§æ—¥æœŸæ ¼å¼å°è¯•è§£æ'time'å­—æ®µï¼Œå°½å¯èƒ½å¤šåœ°ä¿ç•™æœ‰æ•ˆæ•°æ®ã€‚
>
> 2. **æœ‰æ•ˆæ€§æ£€æŸ¥**ï¼šæ¯æ¬¡è¿‡æ»¤æˆ–å¤„ç†åï¼Œæ£€æŸ¥æ•°æ®æ˜¯å¦ä¸ºç©ºï¼Œé¿å…åç»­æ“ä½œæŠ¥é”™ã€‚
>
> 3. **æ¡ä»¶æ‰§è¡Œåˆ†æ**ï¼šåªåœ¨å­˜åœ¨æœ‰æ•ˆæ•°æ®æ—¶æ‰§è¡Œæ—¶é—´ç›¸å…³åˆ†æï¼Œå¦åˆ™è·³è¿‡ç›¸å…³æ­¥éª¤ã€‚
>
> 4. **å¢å¼ºé”™è¯¯å¤„ç†**ï¼šåœ¨å…³é”®æ“ä½œå‘¨å›´æ·»åŠ try-exceptå—ï¼Œæ•è·å¼‚å¸¸å¹¶ç»™å‡ºå‹å¥½æç¤ºã€‚
>
> 5. **æ—¥å¿—å’Œåé¦ˆ**ï¼šåœ¨æ§åˆ¶å°è¾“å‡ºè¯¦ç»†å¤„ç†æ­¥éª¤å’Œé—®é¢˜ï¼Œå¸®åŠ©ç”¨æˆ·è¯Šæ–­æ•°æ®é—®é¢˜ã€‚
>
> é€šè¿‡ä»¥ä¸Šæªæ–½ï¼Œå³ä½¿ç”¨æˆ·çš„æ—¶é—´æ•°æ®å…¨éƒ¨æ— æ•ˆï¼Œä»£ç ä¹Ÿèƒ½ä¼˜é›…åœ°è·³è¿‡ç›¸å…³åˆ†æï¼Œç»§ç»­æ‰§è¡Œå…¶ä»–éƒ¨åˆ†ï¼Œæˆ–ç”Ÿæˆæœ‰æ„ä¹‰çš„æŠ¥å‘Šè¯´æ˜æ—¶é—´æ•°æ®çš„ç¼ºå¤±æƒ…å†µã€‚
>
> 



é’ˆå¯¹æ•°æ®é›†ä¸­æ—¶é—´å­—æ®µå¯èƒ½å­˜åœ¨ç¼ºå¤±æˆ–æ ¼å¼ä¸ä¸€è‡´çš„æƒ…å†µï¼Œä»¥ä¸‹æ˜¯æ”¹è¿›åçš„å¥å£®åŒ–åˆ†ææ–¹æ¡ˆï¼š

```python
import pandas as pd
import matplotlib.pyplot as plt
from datetime import datetime

def robust_time_processing(df):
    """
    é²æ£’çš„æ—¶é—´æ•°æ®å¤„ç†æµç¨‹ï¼ŒåŒ…å«å¤šå±‚é˜²å¾¡æœºåˆ¶
    è¿”å›ï¼š(æœ‰æ•ˆæ—¶é—´æ ‡å¿—, å¤„ç†åçš„æ•°æ®)
    """
    # ä¸´æ—¶ä¿å­˜åŸå§‹æ—¶é—´ç‰¹å¾
    df = df.assign(raw_time=df['time'].copy())
    
    # å¤šå±‚çº§æ—¶é—´è§£æç­–ç•¥
    time_parsing_strategies = [
        # ç­–ç•¥1ï¼šä½¿ç”¨ç°æœ‰datetimeåˆ—ï¼ˆå¦‚æœæœ‰æœ‰æ•ˆæ•°æ®ï¼‰
        {'field': 'datetime', 'action': lambda x: pd.to_datetime(x, errors='coerce')},
        
        # ç­–ç•¥2ï¼šè§£ætimeå­—æ®µçš„å¤šç§æ ¼å¼
        {'field': 'time', 'action': [
            lambda x: pd.to_datetime(x, format='%Y-%m-%d %H:%M:%S', errors='coerce'),
            lambda x: pd.to_datetime(x, format='%Y/%m/%d', errors='coerce'),
            lambda x: pd.to_datetime(x, format='%d-%b-%y', errors='coerce')
        ]},
        
        # ç­–ç•¥3ï¼šæå–æ–‡æœ¬å†…å®¹ä¸­çš„æ—¶é—´ç‰¹å¾
        {'field': 'content', 'action': lambda x: x.str.extract(r'(\d{4}-\d{2}-\d{2})')[0]}
    ]
    
    # è‡ªåŠ¨é€‰æ‹©æœ‰æ•ˆæ—¶é—´æº
    valid_datetime = None
    for strategy in time_parsing_strategies:
        field = strategy['field']
        actions = strategy['action'] if isinstance(strategy['action'], list) else [strategy['action']]
        
        for action in actions:
            try:
                temp_time = action(df[field])
                if temp_time.notna().sum() > 0:
                    valid_datetime = temp_time
                    print(f"æ—¶é—´è§£ææˆåŠŸï¼šä½¿ç”¨å­—æ®µ[{field}]ï¼Œæ¨¡å¼{action.__name__ if hasattr(action,'__name__') else 'custom'}")
                    break
            except Exception as e:
                print(f"æ—¶é—´è§£æè­¦å‘Šï¼šå­—æ®µ[{field}]ç­–ç•¥å¼‚å¸¸ - {str(e)}")
        if valid_datetime is not None:
            break
    
    # æœ‰æ•ˆæ€§éªŒè¯
    if valid_datetime is None:
        print("æœªæ‰¾åˆ°æœ‰æ•ˆæ—¶é—´æ•°æ®æºï¼Œå°†è·³è¿‡æ—¶é—´ç›¸å…³åˆ†æ")
        return False, df
    
    # è®¾ç½®æœ‰æ•ˆæ—¶é—´åºåˆ—
    try:
        df['valid_datetime'] = valid_datetime
        
        # åˆ›å»ºæ ‡å‡†åŒ–æ—¶é—´ç»´åº¦
        df = df.assign(
            year = df['valid_datetime'].dt.year,
            month = df['valid_datetime'].dt.month,
            year_month = df['valid_datetime'].dt.to_period('M'),
            day_period = df['valid_datetime'].dt.hour.apply(
                lambda x: 'å‡Œæ™¨' if 0<=x<6 else 'ä¸Šåˆ' if 6<=x<12 else 'ä¸‹åˆ' if 12<=x<18 else 'æ™šä¸Š')
        )
        
        return True, df
    except Exception as e:
        print(f"æ—¶é—´ç»´åº¦æ„å»ºå¤±è´¥ï¼š{str(e)}")
        return False, df

def guarded_visualization(df, has_valid_time):
    """é˜²å¾¡æ€§å¯è§†åŒ–æœºåˆ¶"""
    figures = []
    
    try:
        # åŸºç¡€æƒ…æ„Ÿåˆ†å¸ƒç›´æ–¹å›¾ï¼ˆå§‹ç»ˆå¯ç”¨ï¼‰
        plt.figure(figsize=(10,6))
        df['sentiment'].hist(bins=20)
        plt.title('æƒ…æ„Ÿå¾—åˆ†å…¨å±€åˆ†å¸ƒ')
        figures.append(plt.gcf())
    except Exception as e:
        print(f"åŸºç¡€å¯è§†åŒ–å¤±è´¥ï¼š{str(e)}")
    
    if has_valid_time:
        try:
            # æ—¶é—´å…³è”åˆ†æï¼ˆä»…åœ¨æœ‰æ•ˆæ—¶é—´æ—¶æ‰§è¡Œï¼‰
            plt.figure(figsize=(16, 8))
            
            # æœˆåº¦è¶‹åŠ¿
            ax1 = plt.subplot(2, 2, 1)
            df.groupby('year_month')['sentiment'].mean().plot(
                marker='o', ax=ax1, title='æœˆåº¦æƒ…æ„Ÿå‡å€¼è¶‹åŠ¿'
            )
            
            # æ—¶æ®µåˆ†å¸ƒ
            ax2 = plt.subplot(2, 2, 2)
            df['day_period'].value_counts().plot.pie(
                autopct='%.1f%%', ax=ax2, title='æ—¶é—´æ®µåˆ†å¸ƒ'
            )
            
            # å¹´åº¦å¯¹æ¯”
            ax3 = plt.subplot(2, 2, (3,4))
            df.groupby('year')['sentiment'].agg(['mean','count']).plot.bar(
                subplots=True, ax=ax3, title='å¹´åº¦æƒ…æ„Ÿå¯¹æ¯”'
            )
            
            plt.tight_layout()
            figures.append(plt.gcf())
        except Exception as e:
            print(f"æ—¶é—´å¯è§†åŒ–å¼‚å¸¸ï¼š{str(e)}")
    
    return figures

def failure_analysis_report(df):
    """ç”Ÿæˆæ•°æ®è´¨é‡è¯Šæ–­æŠ¥å‘Š"""
    report = []
    
    # æ—¶é—´å­—æ®µåˆ†æ
    time_report = {
        'total_entries': len(df),
        'na_in_time': df['time'].isna().sum(),
        'time_format_samples': df['time'].dropna().sample(3, replace=True).tolist()
    }
    
    report.append(
        "æ—¶é—´å­—æ®µè´¨é‡åˆ†æï¼š\n" +
        "\n".join([f" - {k}: {v}" for k,v in time_report.items()])
    )
    
    return "\n".join(report)

def resilient_analysis_pipeline(df):
    """å®¹é”™åˆ†ææµç¨‹"""
    # é˜¶æ®µ1ï¼šæ—¶é—´æ•°æ®å¤„ç†
    time_valid_flag, temp_df = robust_time_processing(df)
    
    # é˜¶æ®µ2ï¼šé˜²å¾¡æ€§å¯è§†åŒ–
    figures = guarded_visualization(temp_df, time_valid_flag)
    
    # é˜¶æ®µ3ï¼šç”Ÿæˆè¯Šæ–­æŠ¥å‘Š
    quality_report = failure_analysis_report(df)
    
    # ç»“æœä¿å­˜æœºåˆ¶
    try:
        temp_df.to_csv('processed_data.csv', index=False)
        print("å¤„ç†ç»“æœå·²ä¿å­˜")
    except Exception as e:
        print(f"ç»“æœä¿å­˜å¤±è´¥ï¼š{str(e)}")
    
    return temp_df, quality_report, figures

# ----------- æ‰§è¡Œç¤ºä¾‹ -----------
# processed_df, report, figs = resilient_analysis_pipeline(raw_df)
```

**æ”¹è¿›äº®ç‚¹è¯´æ˜ï¼š**

1. **æ™ºèƒ½æ—¶é—´è§£ææœºåˆ¶**ï¼š
   - ä¸‰çº§é€’è¿›å¼æ—¶é—´æºè¯†åˆ«ï¼ˆdatetimeåˆ— > timeåˆ—å¤šæ ¼å¼è§£æ > å†…å®¹æŒ–æ˜ï¼‰
   - æ¯ä¸ªè§£æç­–ç•¥ç‹¬ç«‹é”™è¯¯æ•è·ï¼Œé¿å…å•ä¸ªå¤±è´¥å¯¼è‡´å…¨éƒ¨ä¸­æ–­
   - è‡ªåŠ¨é€‰æ‹©å«æœ‰æ•ˆæ•°æ®æœ€å¤šçš„è§£ææ–¹å¼

2. **å…¨æµç¨‹é˜²å¾¡ä½“ç³»**ï¼š
   ```python
   try:
       # ä¸»å¤„ç†é€»è¾‘
   except Exception as e:
       print(f"é˜²å¾¡æ•è·ï¼š{type(e).__name__} - {str(e)}")
       # ä¿å­˜å½“å‰è¿›åº¦
       emergency_save(current_state)
   ```

3. **å¯è§†åŒ–å®‰å…¨æœºåˆ¶**ï¼š
```python
def guarded_visualization(...):
    if has_valid_time and len(df) >= 5:  # æœ€å°‘æ•°æ®ç‚¹è¦æ±‚
        # æ‰§è¡Œæ—¶é—´ç›¸å…³å¯è§†åŒ–
    else:
        print("å¯è§†åŒ–è·³è¿‡ï¼šæ— è¶³å¤Ÿæ—¶åºæ•°æ®")
```

4. **æ•°æ®è´¨é‡é›·è¾¾æŠ¥å‘Š**ï¼š
   - è‡ªåŠ¨æ£€æµ‹æ—¶é—´å­—æ®µçš„ç©ºå€¼ç‡
   - å±•ç¤ºåŸå§‹æ—¶é—´æ•°æ®æ ·æœ¬
   - ç»Ÿè®¡æœ‰æ•ˆè§£æç‡

**æ‰§è¡Œè·¯å¾„è¯´æ˜ï¼š**

```mermaid
graph TD
    A[åŸå§‹æ•°æ®] --> B{æ—¶é—´è§£æ}
    B -->|æˆåŠŸ| C[æ—¶é—´ç»´åº¦æ„å»º]
    B -->|å¤±è´¥| D[åŸºç¡€åˆ†ææ¨¡å¼]
    C --> E[æ—¶åºç›¸å…³å¯è§†åŒ–]
    D --> F[ç”Ÿæˆæ•°æ®è´¨é‡æŠ¥å‘Š]
    E --> G[ç»¼åˆç»“æœä¿å­˜]
    F --> G
    G --> H[ç»“æŸ]
```

**è¯Šæ–­å»ºè®®ï¼š**

å½“å‡ºç°åˆ†æå¼‚å¸¸æ—¶ï¼Œå»ºè®®æŒ‰ä»¥ä¸‹æ­¥éª¤æ’æŸ¥ï¼š

1. **æ•°æ®åˆç­›**ï¼š
```python
print("æ—¶é—´å­—æ®µæ ·ä¾‹ï¼š\n", df['time'].sample(5))
print("ç©ºå€¼æ¯”ä¾‹ï¼š", df['time'].isna().mean())
```

2. **æ ¼å¼æ£€æµ‹**ï¼š
```python
from dateutil.parser import parse
def try_parse(date_str):
    try:
        parse(date_str)
        return True
    except:
        return False

print("å¯è§£ææ¯”ä¾‹ï¼š", df['time'].apply(try_parse).mean())
```

3. **å®¹é”™æµ‹è¯•**ï¼š
```python
test_cases = [
    pd.DataFrame({'time': ['2023-13-01', '2022-02-30']}),  # æ— æ•ˆæ—¥æœŸ
    pd.DataFrame(),  # ç©ºæ•°æ®
    pd.DataFrame({'time': ['æ˜¨æ—¥', 'ä¸Šå‘¨ä¸‰']})  # ä¸­æ–‡æ—¥æœŸ
]

for case in test_cases:
    print(f"\næµ‹è¯•ç”¨ä¾‹ï¼š{case}")
    resilient_analysis_pipeline(case)
```

é€šè¿‡è¿™ç§å¤šå±‚æ¬¡çš„é˜²å¾¡æœºåˆ¶ï¼Œå¯ç¡®ä¿åœ¨ä»¥ä¸‹å…¸å‹åœºæ™¯ä¸­ä¿æŒç¨³å®šï¼š

| å¼‚å¸¸ç±»å‹                | ç³»ç»Ÿå“åº”                                                                 |
|-------------------------|--------------------------------------------------------------------------|
| æ—¶é—´å­—æ®µå…¨éƒ¨ä¸ºç©º        | è·³è¿‡æ—¶åºåˆ†æï¼Œç”Ÿæˆè´¨é‡æŠ¥å‘Š                                               |
| æ··åˆæ—¥æœŸæ ¼å¼            | è‡ªåŠ¨é€‰æ‹©å¯è§£æçš„æ ¼å¼è¿›è¡Œè½¬æ¢                                             |
| å­˜åœ¨éæ³•æ—¥æœŸå€¼ï¼ˆå¦‚2æœˆ30æ—¥ï¼‰ | è½¬ä¸ºNaTå¹¶ä¿ç•™å…¶ä»–æœ‰æ•ˆæ•°æ®                                                |
| éç»“æ„åŒ–æ—¶é—´ä¿¡æ¯        | å°è¯•ä»contentå­—æ®µæå–æ—¶é—´ç‰¹å¾                                           |
| å¯è§†åŒ–æ•°æ®ä¸è¶³          | æ™ºèƒ½é™çº§ä¸ºç®€å•ç»Ÿè®¡è¡¨ï¼Œé¿å…å›¾å½¢æ¸²æŸ“é”™è¯¯                                   |

æ­¤æ–¹æ¡ˆé€šè¿‡å‰ç½®æ ¡éªŒã€ä¸­é—´é˜²æŠ¤ã€åç½®éªŒè¯çš„ä¸‰æ®µå¼é˜²å¾¡ï¼Œç¡®ä¿åˆ†ææµç¨‹çš„æŒç»­æ€§å’Œç»“æœçš„å¯è§£é‡Šæ€§ã€‚
