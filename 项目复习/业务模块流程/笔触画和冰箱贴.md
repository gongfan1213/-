# 业务流程
## 第一种
- 本地选图-》进入图片裁剪->ai生成图->创建项目->2D显示/3d渲染->属性编辑->修改保存

## 第二种
- 历史导入的-》直接2d显示或者3d渲染-〉属性编辑-》修改保存
- 属性编辑可以退回到2d显示3d渲染

# 具体实现
### 1. CMS配置
- 笔触画风格化列表
- 冰箱贴风格化类型
- 冰箱贴风格化列表

### 2. 冰箱贴裁剪
- 裁剪修改支持椭圆设置，并自定义裁剪图形
- 添加画布，获取图像轮廓图片，支持图像元素缩放，同步到右侧长宽设置

### 3. AI生图
### 图像处理工作流程

#### Workflow 1: 用户上传图片并进行风格迁移

1. **开始**
   - 用户上传图片。

2. **Step 1: 可选**
   - **风格迁移**：用户可以选择是否进行风格迁移。
   - **多种模板**：提供多种风格模板供用户选择。

3. **Step 2: 可选**
   - **去除背景**：用户可以选择是否去除背景。

#### Workflow 2: 提取深度图

4. **Step 3: 转深度图**
   - **提取深度图**：从上传的图片中提取深度图。
   - **浮雕与深度图**：浮雕与深度图使用不同的模型，同一个服务分为不同的接口来调用。

#### Workflow 3: 图像生成

5. **原图/去背景图 + 深度图**
   - **softedge**：生成软边缘图。
   - **depth**：生成深度图。

#### Workflow 4: 图像增强

6. **Step 4: 图像增强**
   - **自定义浮雕**：用户可以选择不进行去背景处理。
   - **浮雕水箱**：需要进行去背景处理（确定）。

7. **Step 5: 图像增强**
   - **图像增强**：对图像进行增强处理，包括色彩调整、细节增强等。

8. **UV打印**
   - **最终输出**：将处理后的图像进行UV打印。

### 详细步骤

1. **用户上传图片**
   - 用户通过界面上传图片。

2. **风格迁移**
   - 用户可以选择不同的风格模板进行风格迁移。

3. **去除背景**
   - 用户可以选择是否去除图片背景。

4. **提取深度图**
   - 使用不同的模型提取图片的深度图。

5. **生成软边缘图和深度图**
   - 通过 `softedge` 和 `depth` 模型生成软边缘图和深度图。

6. **图像增强**
   - 对图像进行增强处理，包括色彩调整和细节增强。

7. **UV打印**
   - 将处理后的图像进行UV打印，得到最终输出。

### 总结

整个流程包括用户上传图片、风格迁移、去除背景、提取深度图、生成软边缘图和深度图、图像增强以及最终的UV打印。每一步都可以根据用户的选择进行相应的处理，以达到最佳的图像效果。

- 用户上传图片，第一步是可选的，自定义浮雕没有风格前一，浮雕冰箱贴用户可以选择是否进行风格前一，多个模版，风格前一，第二部也是可选的，自定义浮雕没有去处背景，浮雕冰箱贴用户可以选择是否去处背景，接下来提取深度图，浮雕和笔触使用的是不同的模型，同一个服务分为不同的接口来调用的，原图/去处背后图+深度图
- 基于深度图使用图生图的方法，使用softedge+depth控制图，生产生带细节的深度图，softedge，depth，生成带有细节的深度图，原图输入+深度图-》之后处理，使用明暗明显，并且柔和，抠图，调整对比度，色阶等等，图像增强，
- 自定义浮雕不进行去背景，浮雕冰箱贴需要进行去处背景
### 图像处理流程详细讲解

这个流程图展示了一个图像处理的工作流程，具体步骤如下：

1. **得到裁剪图**
   - 开始时，用户上传或选择一张裁剪后的图像。

2. **风格化接口**
   - 图像首先通过风格化接口进行处理。这一步可能包括应用特定的图像风格或滤镜，以达到预期的视觉效果。

3. **判断是否需要去背景**
   - 接下来，系统判断图像是否需要去除背景。
   - 如果需要去背景（true），则进入去背景接口。
   - 如果不需要去背景（false），则直接进入下一步。

4. **去背景接口**
   - 如果图像需要去背景，系统会调用去背景接口，去除图像的背景部分。

5. **AI生成灰度图接口**
   - 无论是否去背景，图像都会通过AI生成灰度图接口。这一步使用AI技术生成图像的灰度图，可能用于后续的深度处理或其他图像增强操作。

6. **再次判断是否需要去背景**
   - 在生成灰度图后，系统再次判断图像是否需要去背景。
   - 如果需要去背景（true），则进入图像后处理步骤。
   - 如果不需要去背景（false），则直接进入2D显示或3D渲染步骤。

7. **图像后处理**
   - 如果图像需要进一步处理，系统会进行图像后处理。这一步可能包括色彩调整、细节增强等操作，以提高图像的质量和视觉效果。

8. **2D显示/3D渲染**
   - 最后，处理后的图像可以用于2D显示或3D渲染。根据具体应用场景，图像可以在2D界面上显示，或者用于3D模型的纹理渲染。

### 总结

这个图像处理流程包括以下关键步骤：
- 图像的风格化处理
- 判断并去除背景
- 使用AI生成灰度图
- 图像的后处理
- 最终的2D显示或3D渲染

每一步都根据具体需求进行相应的处理，以确保最终图像达到预期的效果。这个流程可以应用于各种图像处理场景，如照片编辑、图像增强、3D建模等。
# 2d显示/3d渲染
- 复用纹理应用
# 纹理打印实现
- 复用纹理应用
# 接口相关
### 接口定义

#### 1. CMS 列表配置

##### 笔触画风格化列表

- **字段**
  - `type`
    - **类型**: `enum`
    - **注释**: 风格化类型
  - `image`
    - **类型**: `file`
    - **注释**: 显示图片

##### 冰箱贴风格化类型

- **字段**
  - `type`
    - **类型**: `enum`
    - **注释**: 风格化类型

##### 冰箱贴风格化列表

- **字段**
  - `type`
    - **类型**: `enum`
    - **注释**: 风格化类型
  - `image`
    - **类型**: `file`
    - **注释**: 显示图片
# 浮雕库相关的内容
<img width="750" alt="image" src="https://github.com/user-attachments/assets/d79404b0-635c-4a3a-a479-a1cb669e9162" />
# 进入
- 1.编辑器点击2.5dcraft 打开面板，点击右上角的x关闭
- 2.应用卡片排列展示，点击打开相应的应用，与平面应用是一致的
<img width="236" alt="image" src="https://github.com/user-attachments/assets/0c1d6ba7-e8ba-40a7-809c-d61fe0f81e0f" />
### Relief Lib

1. **点击卡片进入浮雕库应用，点击叉叉关闭面板**
2. **点击tab切换纹理类型面板**
3. **Color Relief**：
   - a. 使用cmyk墨水打印的浮雕，白墨堆高，彩墨覆盖
   - b. 分组展示不同类型的预置浮雕库，交互结构与elements一致
   - c. 会遮挡下方图层的图案
4. **Gloss Relief**：
   - a. 使用光油打印的浮雕，叠加在原图上，透明遮挡下面的图案
   - b. 分组展示不同类型的预置浮雕库，交互结构与elements一致
5. **浮雕与浮雕、浮雕与纹理之间不会叠加，只有在拼接**
6. **Tips**：
   - 点击图标展开tips弹窗，图文介绍，点击关闭

### Relief Feature

- **描述**：
  - Add Realistic Tactile And Visual Textures To Your Crafts. Try It With Various Templates, And More To Preview And Create Unique Designs Effortlessly!
### 从浮雕库添加浮雕至画布

#### 点击：
1. **点击浮雕库中的浮雕卡片**：
   - 将此浮雕添加进画布中心，顶层。
2. **图层列表新增此2.5D图层**：
   - 默认名为Relief，在最顶层，可正常拖拽、删除、重命名等。
3. **重复点击则重复添加**：
   - 平铺放在上一次此添加元素的旁边。

#### 拖拽：
1. **在浮雕库中选择浮雕**：
   - 长按鼠标拖拽至画布区域，长按时鼠标为卡片。
2. **放开鼠标**：
   - 在鼠标位置添加该浮雕。
3. **拖拽至画布区外无效**：
   - 松开鼠标清空。
### 图层属性：

1. **浮雕图层在图层列表中带有2.5D标签**：
   - 可正常拖拽、修改顺序、删除、复制、改名。

2. **浮雕图层被选中时**：
   - 选中框有上方有2.5D标签。

3. **缩放**：
   - 选中浮雕后出现2.5D选中框。

4. **将2.5D效果删除**：
   - 点击右键菜单 `remove 2.5D Effect` 功能，选所选对象变成普通图层，如果选中对象中没有任何2.5D图层则没有此选项。

5. **移除底图**：
   - ？？？
  
# 3d预览
### 3D预览

1. **点击3D视角按钮**：
   - 进入3D视角，再次点击退出。

2. **3D视角**：
   - a. 统一用平面底板（暂不考虑画布类型），底板大小与画布大小一致，半透明，可从背面查看。
   - b. 平面区域直接显示平面，2.5D区域显示立体效果，可实时调节厚度。

3. **切换至3D视野时，显示参数调节面板**：
   - a. 参数面板只显示2.5D图层的可调参数。
   - b. 内置的浮雕元素均有各自默认参数。
   - c. 各浮雕元素可分别设置不同参数。
   - d. 可调参数：
     - i. **Thickness**：浮雕厚度，默认值（），可调范围（）；同一画布中所有浮雕图层只能设置同一种厚度。
     - ii. **Smoothness**：调整灰度图的对比度控制模型光滑程度，没有单位，范围[-10,10]，默认为0光滑层中，步长1。
     - iii. **Invert**：是否反转灰度像素。
    
<img width="556" alt="image" src="https://github.com/user-attachments/assets/e6ba6d5f-477a-458e-93d3-a0e1d551d387" />
