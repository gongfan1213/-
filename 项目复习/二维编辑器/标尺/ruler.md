> ğŸ’­ å¥½çš„ï¼Œç”¨æˆ·ä¹‹å‰è®©æˆ‘åˆ†æè¿‡`guideline.ts`çš„ä»£ç ï¼Œå¹¶ç»™å‡ºäº†åé¦ˆã€‚ç°åœ¨ä»–ä»¬æä¾›äº†`ruler.ts`çš„ä¸€éƒ¨åˆ†ä»£ç ï¼Œå¹¶è¯´ä¹‹åä¼šç»§ç»­æä¾›å‰©ä¸‹çš„ã€‚ç”¨æˆ·å›å¤â€œç»§ç»­ä½ è¿˜æ²¡æœ‰è¯´å®Œå‘¢â€ï¼Œè¯´æ˜æˆ‘ä¹‹å‰å¯èƒ½ä¸­æ–­äº†ï¼Œéœ€è¦ç»§ç»­å®Œæˆå¯¹ç°æœ‰ä»£ç çš„åˆ†æã€‚
>
> é¦–å…ˆï¼Œæˆ‘åº”è¯¥å›é¡¾ä¹‹å‰çš„å¯¹è¯ï¼Œç¡®è®¤ä¹‹å‰åˆ†æåˆ°å“ªé‡Œäº†ã€‚æ ¹æ®å†å²è®°å½•ï¼Œæˆ‘ä¹‹å‰åˆ†æäº†`guideline.ts`å¹¶ç»™å‡ºäº†ä¼˜åŒ–å»ºè®®ï¼Œä¹‹åç”¨æˆ·æä¾›äº†`ruler.ts`çš„ä»£ç ç‰‡æ®µï¼Œå¯èƒ½å¸Œæœ›æˆ‘ç»§ç»­å¯¹è¿™éƒ¨åˆ†ä»£ç è¿›è¡Œåˆ†æå’Œä¼˜åŒ–ã€‚
>
> ç°åœ¨éœ€è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼Œæ ¹æ®æä¾›çš„`ruler.ts`ä»£ç ï¼Œåˆ†æå…¶ä¸è¾…åŠ©çº¿åŠŸèƒ½çš„å…³è”ï¼Œæ£€æŸ¥æ½œåœ¨é—®é¢˜ï¼Œå¹¶æå‡ºä¼˜åŒ–å»ºè®®ã€‚äº†è§£åˆ°`ruler.ts`æ˜¯ä¸€ä¸ªæ ‡å°ºç»„ä»¶ï¼Œå¯èƒ½è´Ÿè´£ç»˜åˆ¶ç”»å¸ƒä¸Šçš„æ ‡å°ºï¼Œå¹¶ä¸è¾…åŠ©çº¿ï¼ˆ`guideline.ts`ï¼‰è¿›è¡Œäº¤äº’ï¼Œæ¯”å¦‚æ£€æµ‹é¼ æ ‡ä½ç½®ã€å¤„ç†äº‹ä»¶ç­‰ã€‚
>
> æ¥ä¸‹æ¥ï¼Œæˆ‘éœ€è¦å¼€å§‹é˜…è¯»å¹¶ç†è§£ç”¨æˆ·æä¾›çš„`ruler.ts`ä»£ç çš„ç‰‡æ®µã€‚ä»ä»£ç ç»“æ„æ¥çœ‹ï¼Œ`CanvasRuler`ç±»åˆå§‹åŒ–æ—¶åˆå¹¶äº†é…ç½®é¡¹ï¼Œæ³¨å†Œäº†äº‹ä»¶å¤„ç†ï¼Œå¹¶è°ƒç”¨`setupGuideLine()`æ¥è®¾ç½®è¾…åŠ©çº¿ã€‚è¯¥ç±»åŒ…å«ä¸æ ‡å°ºæ¸²æŸ“ã€äº‹ä»¶å¤„ç†ï¼ˆå¦‚é¼ æ ‡æŒ‰ä¸‹ã€ç§»åŠ¨ã€é‡Šæ”¾ï¼‰ã€æ˜¾ç¤º/éšè—è¾…åŠ©çº¿ç­‰åŠŸèƒ½ç›¸å…³çš„æ–¹æ³•ã€‚åŒæ—¶ä½¿ç”¨äº†`throttle`æ¥é™åˆ¶æŸäº›äº‹ä»¶çš„å¤„ç†é¢‘ç‡ã€‚
>
> æ¥ä¸‹æ¥ï¼Œæˆ‘éœ€è¦åˆ†æç°æœ‰`ruler.ts`ä»£ç å¯èƒ½å­˜åœ¨çš„é—®é¢˜ï¼š
>
> 1. **äº‹ä»¶å¤„ç†å™¨çš„ç»‘å®šä¸è§£ç»‘**ï¼šåœ¨`enable`æ–¹æ³•ä¸­ç»‘å®šäº†å¤šä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œä½†åœ¨`disable`æ˜¯å¦å…¨éƒ¨æ­£ç¡®è§£ç»‘ï¼Ÿæ¯”å¦‚`after:render`äº‹ä»¶å¯èƒ½è¢«ç»‘å®šäº†ä¸¤æ¬¡ï¼Œåˆ†åˆ«å¯¹åº”`calcObjectRect`å’Œ`render`ï¼Œåœ¨è§£ç»‘æ—¶éœ€è¦ç¡®ä¿ä¸¤æ¬¡éƒ½è§£é™¤ã€‚
>
> 2. **ç±»å‹å®‰å…¨ä¸ç±»å‹æ‰©å±•**ï¼šåœ¨æ„é€ å‡½æ•°ä¸­ä½¿ç”¨`fabric.util.object.extend`æ‰©å±•äº†`canvas`å¯¹è±¡ï¼Œæ·»åŠ äº†`ruler`å±æ€§ï¼Œä½†TypeScriptç¯å¢ƒä¸‹å¯èƒ½ç¼ºå°‘ç±»å‹å£°æ˜ï¼Œå¯¼è‡´è®¿é—®`canvas.ruler`æ—¶ç±»å‹é”™è¯¯ã€‚
>
> 3. **æ–¹æ³•å¯è§æ€§ä¸ä¿æŠ¤**ï¼šæŸäº›æ–¹æ³•å¦‚`handleGuideline`æˆ–`calcObjectRect`æ˜¯å¦åº”è¯¥è®¾ç½®ä¸ºç§æœ‰ï¼ˆprivateï¼‰ä»¥é™åˆ¶è®¿é—®ï¼Ÿ
>
> 4. **æ€§èƒ½ä¼˜åŒ–**ï¼šå·²ç»ä½¿ç”¨äº†`throttle`å¯¹éƒ¨åˆ†äº‹ä»¶å¤„ç†è¿›è¡ŒèŠ‚æµï¼Œä½†å¯èƒ½éœ€è¦æ£€æŸ¥èŠ‚æµæ—¶é—´è®¾ç½®æ˜¯å¦åˆç†ï¼Œæ˜¯å¦æœ‰æ›´é«˜æ•ˆçš„å¤„ç†æ–¹å¼ã€‚
>
> 5. **ä»£ç æ³¨é‡Šå’Œå¯è¯»æ€§**ï¼šéƒ¨åˆ†æ–¹æ³•æˆ–å¤æ‚é€»è¾‘æ˜¯å¦æœ‰è¶³å¤Ÿçš„æ³¨é‡Šï¼Œä»¥ä¾¿å…¶ä»–å¼€å‘è€…ç†è§£ï¼Ÿ
>
> 6. **è¾…åŠ©çº¿ä¸æ ‡å°ºçš„äº¤äº’**ï¼šåœ¨`ruler.ts`ä¸­å¦‚ä½•å¤„ç†è¾…åŠ©çº¿çš„åˆ›å»ºã€ç§»åŠ¨å’Œåˆ é™¤ï¼Œæ˜¯å¦å­˜åœ¨é€»è¾‘æ¼æ´ï¼Ÿæ¯”å¦‚åœ¨`canvasMouseDown`æˆ–`canvasMouseMove`ä¸­æ˜¯å¦æ­£ç¡®å¤„ç†äº†è¾…åŠ©çº¿çš„ç”Ÿæˆå’Œä½ç½®æ›´æ–°ã€‚
>
> 7. **èµ„æºç®¡ç†ä¸å†…å­˜æ³„æ¼**ï¼šæ˜¯å¦æ­£ç¡®ç§»é™¤äº†æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨å’Œä¸´æ—¶å¯¹è±¡ï¼Ÿä¾‹å¦‚åœ¨`destroy`æˆ–`disable`æ–¹æ³•ä¸­æ˜¯å¦å½»åº•æ¸…ç†èµ„æºã€‚
>
> åŸºäºä»¥ä¸Šé—®é¢˜ï¼Œæˆ‘éœ€è¦é€ä¸€æ£€æŸ¥ä»£ç ï¼Œæ‰¾åˆ°æ½œåœ¨é—®é¢˜å¹¶æå‡ºä¼˜åŒ–å»ºè®®ã€‚ä¾‹å¦‚ï¼š
>
> **äº‹ä»¶è§£ç»‘é—®é¢˜**ï¼šç¡®ä¿æ¯æ¬¡ç»‘å®šéƒ½ç”¨å¯¹åº”çš„å‡½æ•°å¼•ç”¨è§£ç»‘ã€‚ä½¿ç”¨`throttle`ç”Ÿæˆçš„å‡½æ•°å¯èƒ½ä¸åŸå§‹å‡½æ•°ä¸åŒï¼Œå¦‚æœç›´æ¥è§£ç»‘åŸå§‹å‡½æ•°ï¼Œå¯èƒ½å¯¼è‡´æœªèƒ½æ­£ç¡®è§£ç»‘ã€‚éœ€è¦ç¡®è®¤åœ¨ç»‘å®šå’Œè§£ç»‘æ—¶ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªå‡½æ•°å¼•ç”¨ã€‚ä½†æ˜¯ç”¨æˆ·å½“å‰ä»£ç ä¸­`eventHandler`å·²ç»å°†èŠ‚æµåçš„å‡½æ•°å­˜ä¸‹æ¥ï¼Œå› æ­¤åœ¨è§£ç»‘æ—¶åº”æ­£ç¡®åº”ç”¨è¿™äº›ç¼“å­˜çš„å‡½æ•°ï¼Œé¿å…é—®é¢˜ã€‚
>
> **ç±»å‹æ‰©å±•é—®é¢˜**ï¼šéœ€åœ¨TypeScriptä¸­æ­£ç¡®æ‰©å±•Fabricçš„Canvasç±»å‹ï¼Œæ·»åŠ `ruler`å±æ€§ï¼Œä»¥é¿å…ç±»å‹é”™è¯¯ã€‚
>
> **æ–¹æ³•å¯è§æ€§**ï¼šæ£€æŸ¥æ˜¯å¦æœ‰å…¬æœ‰æ–¹æ³•å¯ä»¥æ”¹ä¸ºç§æœ‰ï¼Œä»¥å°è£…å†…éƒ¨é€»è¾‘ã€‚
>
> **è¾…åŠ©çº¿ç®¡ç†**ï¼šåœ¨`canvasMouseUp`ä¸­å¤„ç†è¾…åŠ©çº¿çš„ç”Ÿæˆå’Œæ·»åŠ æ˜¯å¦è€ƒè™‘åˆ°äº†æ¡ä»¶ï¼Œå¦‚æ˜¯å¦åœ¨æ ‡å°ºä¸Šç‚¹å‡»ã€æ˜¯å¦è¶…å‡ºèŒƒå›´ç­‰ã€‚
>
> æ¥ä¸‹æ¥ï¼Œç»“åˆç”¨æˆ·æä¾›çš„ä»£ç éƒ¨åˆ†ï¼šä¾‹å¦‚`enable`æ–¹æ³•ç»‘å®šäº†å¤šä¸ªäº‹ä»¶ï¼Œå¹¶åœ¨disableä¸­è§£ç»‘ã€‚éœ€è¦ç¡®è®¤äº‹ä»¶åç§°å’Œå›è°ƒå‡½æ•°çš„æ­£ç¡®å¯¹åº”ï¼Œé¿å…é—æ¼æˆ–é”™è¯¯è§£ç»‘ã€‚
>
> å¦å¤–ï¼Œä»£ç ä¸­ä½¿ç”¨äº†`fabric.GuideLine`ï¼Œä½†åœ¨`clearGuideline()`ä¸­ä½¿ç”¨`fabric.GuideLine.prototype.type`ï¼Œè¿™æ˜¯å¦ä¸`guideline.ts`ä¸­å®šä¹‰çš„ç±»å‹ä¸€è‡´ï¼Œæ˜¯å¦æœ‰æ½œåœ¨çš„ç±»å/ç±»å‹é—®é¢˜ï¼Ÿ
>
> æ­¤å¤–ï¼Œéœ€è¦ç¡®ä¿åœ¨ç”Ÿæˆè¾…åŠ©çº¿æ—¶æ­£ç¡®è®¾ç½®äº†å‚æ•°ï¼Œå¦‚`axis`å’Œ`points`ï¼Œé¿å…å‡ºç°åˆå§‹åŒ–é”™è¯¯ã€‚ä¾‹å¦‚ï¼Œåœ¨`handleGuideline`æ–¹æ³•ä¸­ï¼ˆå¯èƒ½å­˜åœ¨äºåç»­ä»£ç ä¸­ï¼‰æ˜¯å¦æ­£ç¡®ä¼ é€’äº†è¿™äº›å‚æ•°ã€‚
>
> åœ¨å¤„ç†æ–¹æ³•æ—¶ï¼Œå¦‚`calcObjectRect`è¢«èŠ‚æµï¼Œå¯èƒ½éœ€è¦ç¡®è®¤ä¸å½±å“å®æ—¶æ€§ï¼Œä½†ç”¨æˆ·å½“å‰è®¾ç½®`15ms`çš„èŠ‚æµæ—¶é—´æ˜¯åˆç†çš„ã€‚ä½†è‹¥ç”¨æˆ·åœ¨ç§»åŠ¨å¯¹è±¡æ—¶æ€§èƒ½ä¸ä½³ï¼Œå¯èƒ½éœ€è¦è°ƒæ•´èŠ‚æµæ—¶é—´æˆ–ä¼˜åŒ–å‡½æ•°é€»è¾‘ã€‚
>
> å…³äºèµ·å§‹ç‚¹åç§»`topOffset`çš„å¤„ç†ï¼šåœ¨`setTopOffset`ä¸­æ›´æ–°äº†`topOffset`å¹¶é‡æ–°æ¸²æŸ“ï¼Œè¿™å¯èƒ½å½±å“æ ‡å°ºçš„ç»˜åˆ¶ä½ç½®ï¼Œéœ€ç¡®ä¿åœ¨è®¡ç®—æ ‡å°ºå’Œè¾…åŠ©çº¿æ—¶æ­£ç¡®åº”ç”¨äº†è¯¥åç§»ã€‚
>
> æœ€åï¼Œè€ƒè™‘æ½œåœ¨çš„ä»£ç ä¼˜åŒ–ï¼Œå¦‚åˆå¹¶é‡å¤çš„ä»£ç å—ï¼Œä½¿ç”¨æ›´é«˜æ•ˆçš„æ¸²æŸ“æ–¹æ³•ï¼Œå‡å°‘ä¸å¿…è¦çš„é‡ç»˜ç­‰ã€‚
>
> 



### **ruler.ts ä»£ç åˆ†æä¸ä¼˜åŒ–å»ºè®®**

---

#### **ä¸€ã€æ ¸å¿ƒåŠŸèƒ½è§£æ**
`CanvasRuler` ç±»è´Ÿè´£å®ç° Fabric.js ç”»å¸ƒçš„æ ‡å°ºåŠŸèƒ½ï¼Œå¹¶ä¸è¾…åŠ©çº¿ (`GuideLine`) æ·±åº¦é›†æˆï¼Œå…³é”®ç‰¹æ€§å¦‚ä¸‹ï¼š

1. **æ ‡å°ºæ¸²æŸ“**:
   - åœ¨ç”»å¸ƒé¡¶éƒ¨å’Œå·¦ä¾§ç»˜åˆ¶å¸¦æœ‰åˆ»åº¦çš„æ ‡å°ºã€‚
   - æ ¹æ®ç”»å¸ƒè§†å£åç§»å’Œç¼©æ”¾åŠ¨æ€è°ƒæ•´æ ‡å°ºä½ç½®ã€‚
   - æ”¯æŒé«˜äº®æ˜¾ç¤ºé€‰ä¸­å¯¹è±¡çš„è¾¹ç•Œè¾…åŠ©çº¿ã€‚

2. **è¾…åŠ©çº¿ç®¡ç†**:
   - é€šè¿‡ `setupGuideLine()` åˆå§‹åŒ–è¾…åŠ©çº¿åŠŸèƒ½ã€‚
   - å“åº”é¼ æ ‡äº‹ä»¶ï¼Œå…è®¸ç”¨æˆ·ä»æ ‡å°ºæ‹–åŠ¨åˆ›å»ºè¾…åŠ©çº¿ã€‚
   - æä¾›è¾…åŠ©çº¿æ˜¾éšæ§åˆ¶ (`showGuideline`/`hideGuideline`)ã€‚

3. **äº‹ä»¶äº¤äº’**:
   - ç›‘å¬ `mouse:down`ã€`mouse:move`ã€`mouse:up` å®ç°è¾…åŠ©çº¿æ‹–æ‹½é€»è¾‘ã€‚
   - ä½¿ç”¨èŠ‚æµ (`throttle`) ä¼˜åŒ–é«˜é¢‘äº‹ä»¶ï¼ˆå¦‚ `mousemove`ï¼‰çš„æ€§èƒ½ã€‚

---

#### **äºŒã€æ½œåœ¨é—®é¢˜åˆ†æ**

1. **äº‹ä»¶ç»‘å®šæ³„æ¼**:
   - **é—®é¢˜**: `enable()` æ–¹æ³•ç»‘å®šäº†ä¸¤ä¸ª `after:render` äº‹ä»¶ï¼ˆ`calcObjectRect` å’Œ `render`ï¼‰ï¼Œä½† `disable()` ä¸­æ˜¯å¦ç¡®ä¿è§£ç»‘äº†æ‰€æœ‰äº‹ä»¶ï¼Ÿè‹¥å¤šæ¬¡è°ƒç”¨ `enable()/disable()`ï¼Œå¯èƒ½å¼•å‘é‡å¤ç»‘å®šã€‚
   - **ç¤ºä¾‹ä»£ç **:
     ```ts
     // enable() ä¸­çš„äº‹ä»¶ç»‘å®š
     this.canvas.on('after:render', this.eventHandler.calcObjectRect);
     this.canvas.on('after:render', this.eventHandler.render);
     
     // disable() ä¸­çš„è§£ç»‘
     this.canvas.off('after:render', this.eventHandler.calcObjectRect);
     this.canvas.off('after:render', this.eventHandler.render);
     ```
   - **è§£å†³**: ç¡®ä¿ `.off()` ä¼ å…¥ä¸ `.on()` ç›¸åŒçš„å‡½æ•°å¼•ç”¨ã€‚

2. **ç±»å‹æ‰©å±•ä¸å®Œæ•´**:
   - **é—®é¢˜**: é€šè¿‡ `fabric.util.object.extend` å°† `ruler` å±æ€§æŒ‚è½½åˆ° `canvas` å¯¹è±¡ï¼Œä½†æœªæ‰©å±• TypeScript ç±»å‹ï¼Œå¯èƒ½å¯¼è‡´è®¿é—® `canvas.ruler` æ—¶ç±»å‹æ£€æŸ¥å¤±è´¥ã€‚
   - **ç¤ºä¾‹ä¿®å¤**:
     ```ts
     // åœ¨å…¨å±€ç±»å‹å£°æ˜æ–‡ä»¶ï¼ˆå¦‚ fabric.d.tsï¼‰ä¸­æ‰©å±• Canvas ç±»å‹
     declare module 'fabric/fabric-impl' {
       interface Canvas {
         ruler?: CanvasRuler;
       }
     }
     ```

3. **ä¸´æ—¶è¾…åŠ©çº¿æœªæ¸…ç†**:
   - **é—®é¢˜**: `tempGuidelLine` å¯èƒ½åœ¨æ‹–æ‹½ä¸­é€”è¢«ä¸­æ–­ï¼ˆå¦‚é¡µé¢è·³è½¬ï¼‰ï¼Œæœªæ­£ç¡®æ¸…ç†å¯¼è‡´å†…å­˜æ³„æ¼ã€‚
   - **è§£å†³**: åœ¨ `disable()` æˆ– `destroy()` æ—¶å¼ºåˆ¶ç§»é™¤ä¸´æ—¶è¾…åŠ©çº¿ã€‚

4. **èŠ‚æµå‡½æ•°å¼•ç”¨é—®é¢˜**:
   - **é—®é¢˜**: ä½¿ç”¨ `throttle(this.calcObjectRect.bind(this), 15)` ç”Ÿæˆçš„å‡½æ•°å¯èƒ½ä¸åŸå§‹å‡½æ•°å¼•ç”¨ä¸åŒï¼Œéœ€ç¡®ä¿è§£ç»‘æ—¶ä½¿ç”¨åŒä¸€å¼•ç”¨ã€‚
   - **è§£å†³**: åœ¨ `eventHandler` ä¸­ç¼“å­˜èŠ‚æµåçš„å‡½æ•°ã€‚

---

#### **ä¸‰ã€ä¼˜åŒ–ä¸æ”¹è¿›å»ºè®®**

1. **äº‹ä»¶è§£ç»‘ä¼˜åŒ–**:
   - **å»ºè®®**ï¼šä½¿ç”¨å‘½åå‡½æ•°æ›¿ä»£åŒ¿åå‡½æ•°ï¼Œç¡®ä¿ `.on()` å’Œ `.off()` çš„å¼•ç”¨ä¸€è‡´ã€‚
   - **ç¤ºä¾‹ä»£ç **:
     ```ts
     // åˆå§‹åŒ–æ—¶ç»‘å®šèŠ‚æµå‡½æ•°
     private eventHandler = {
       calcObjectRect: throttle(this.calcObjectRect.bind(this), 15),
       // ...
     };
     ```

2. **å®Œå–„ç±»å‹å£°æ˜**:
   - **å»ºè®®**ï¼šåœ¨é¡¹ç›®çš„å…¨å±€ç±»å‹æ–‡ä»¶ä¸­æ‰©å±• Fabric çš„ `Canvas` æ¥å£ï¼Œæ˜ç¡® `ruler` å±æ€§çš„å­˜åœ¨ã€‚
     ```ts
     // fabric.d.ts
     import { CanvasRuler } from './path-to-ruler';
     declare module 'fabric/fabric-impl' {
       interface Canvas {
         ruler?: CanvasRuler;
       }
     }
     ```

3. **å†…å­˜ç®¡ç†ä¼˜åŒ–**:
   - **å»ºè®®**: åœ¨ `disable()` æ–¹æ³•ä¸­å¢åŠ å¯¹ `tempGuidelLine` çš„æ¸…ç†ã€‚
     ```ts
     public disable() {
       // æ¸…ç†ä¸´æ—¶è¾…åŠ©çº¿
       if (this.tempGuidelLine) {
         this.options.canvas.remove(this.tempGuidelLine);
         this.tempGuidelLine = undefined;
       }
       // å…¶ä»–è§£ç»‘é€»è¾‘...
     }
     ```

4. **ä»£ç å¯ç»´æŠ¤æ€§æå‡**:
   - **å»ºè®®**: æå–é‡å¤ä½¿ç”¨çš„å¸¸é‡ï¼ˆå¦‚é»˜è®¤é¢œè‰²å€¼ï¼‰åˆ°é…ç½®å¯¹è±¡ã€‚
     ```ts
     const DEFAULT_COLORS = {
       background: '#F7F7F7',
       border: '#ddd',
       highlight: '#939393',
       text: '#888',
     };
     
     this.options = Object.assign(DEFAULT_COLORS, _options);
     ```

5. **æ€§èƒ½ä¼˜åŒ–**:
   - **å»ºè®®**: ä½¿ç”¨åŠ¨æ€æ¸²æŸ“å‡å°‘ä¸å¿…è¦çš„é‡ç»˜ã€‚ä¾‹å¦‚ï¼Œä»…åœ¨æ ‡å°ºå¯è§åŒºåŸŸå˜åŒ–ï¼ˆå¦‚æ»šåŠ¨ã€ç¼©æ”¾ï¼‰æ—¶è§¦å‘ `render()`ï¼Œè€Œéæ¯æ¬¡ `after:render`ã€‚

6. **é”™è¯¯å¤„ç†å¢å¼º**:
   - **å»ºè®®**: åœ¨å…³é”®æ“ä½œï¼ˆå¦‚ `setTopOffset`ï¼‰ä¸­æ·»åŠ å‚æ•°æ ¡éªŒã€‚
     ```ts
     public setTopOffset(value: number) {
       if (typeof value !== 'number') {
         throw new Error('Top offset must be a number.');
       }
       this.topOffset = value;
       this.render();
     }
     ```

---

#### **å››ã€å…³é”®ä»£ç æ®µåˆ†æ**

1. **æ ‡å°ºåˆå§‹åŒ–ä¸è¾…åŠ©çº¿é›†æˆ**:
   ```ts
   constructor(_options: RulerOptions) {
     // æ‰©å±• Canvas åŸå‹ï¼ŒæŒ‚è½½ ruler å®ä¾‹
     fabric.util.object.extend(this.options.canvas, {
       ruler: this,
     });
     
     // åˆå§‹åŒ–è¾…åŠ©çº¿æ‰©å±•
     setupGuideLine();
   }
   ```
   - **è¯´æ˜**: é€šè¿‡ `setupGuideLine()` æ‰©å±• Fabric.js åŸç”Ÿ `Line`ï¼Œåˆ›å»ºå¯æ‹–æ‹½çš„è¾…åŠ©çº¿å¯¹è±¡ã€‚

2. **åŠ¨æ€åæ ‡è®¡ç®—**:
   ```ts
   // ç¤ºä¾‹æ–¹æ³•ï¼šè®¡ç®—å¯¹è±¡è¾¹ç•Œè¾…åŠ©çº¿ï¼ˆå¯èƒ½åœ¨æœªå±•ç¤ºçš„ä»£ç ä¸­ï¼‰
   private calcObjectRect() {
     const activeObjects = this.options.canvas.getActiveObjects();
     this.objectRect = this.calcHighlightRect(activeObjects);
     this.render();
   }
   ```
   - **è¯´æ˜**: å®æ—¶è®¡ç®—é€‰ä¸­å¯¹è±¡çš„è¾¹ç•Œï¼Œç»˜åˆ¶è¾…åŠ©é«˜äº®çº¿ã€‚

3. **é¼ æ ‡äº‹ä»¶å¤„ç†**:
   ```ts
   private canvasMouseDown(e: IEvent) {
     if (!this.options.enabled) return;
     this.activeOn = 'down';
     // è§¦å‘è¾…åŠ©çº¿åˆ›å»ºé€»è¾‘ï¼ˆå¯èƒ½åœ¨æœªå±•ç¤ºçš„ handleGuideline æ–¹æ³•ä¸­ï¼‰
     this.handleGuideline(e);
   }
   ```
   - **é€»è¾‘é“¾è·¯**: `mouse:down` â†’ æ£€æµ‹æ˜¯å¦åœ¨æ ‡å°ºåŒºåŸŸ â†’ åˆ›å»ºä¸´æ—¶è¾…åŠ©çº¿ (`tempGuidelLine`)ã€‚

---

#### **äº”ã€æ€»ç»“**
å½“å‰ä»£ç å·²å®ç°æ ‡å°ºä¸è¾…åŠ©çº¿çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œä½†éœ€å…³æ³¨ **äº‹ä»¶ç®¡ç†ã€ç±»å‹å®‰å…¨ã€å†…å­˜æ³„æ¼** ç­‰æ½œåœ¨é—®é¢˜ã€‚é€šè¿‡ä¼˜åŒ–äº‹ä»¶å¼•ç”¨ã€å®Œå–„ç±»å‹å£°æ˜ã€å¢å¼ºé”™è¯¯å¤„ç†ï¼Œå¯æ˜¾è‘—æå‡ä»£ç å¥å£®æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚åç»­å»ºè®®ç»“åˆå®Œæ•´ä»£ç ï¼ˆå°¤å…¶æ˜¯ `handleGuideline`ã€`render` ç­‰æœªå±•ç¤ºçš„éƒ¨åˆ†ï¼‰è¿›ä¸€æ­¥ç»†åŒ–åˆ†æã€‚
