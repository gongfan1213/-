> ğŸ’­ å¥½çš„ï¼Œç”¨æˆ·è®©æˆ‘è¯¦ç»†è®²è§£ä»–ä»¬æä¾›çš„è¿™æ®µä»£ç ï¼Œä»–ä»¬è¡¨ç¤ºæ²¡æœ‰çœ‹æ‡‚ã€‚é¦–å…ˆï¼Œæˆ‘è¦å…ˆé€šè¯»ä»£ç ï¼Œç†è§£æ¯ä¸€éƒ¨åˆ†çš„é€»è¾‘å’Œä½œç”¨ã€‚è¿™æ®µä»£ç çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªä½¿ç”¨Fabric.jså®ç°çš„æ ‡å°ºæ’ä»¶ï¼Œä¸»è¦å¤„ç†æ ‡å°ºä¸Šçš„é¼ æ ‡äº‹ä»¶ï¼Œæ¯”å¦‚åˆ›å»ºå’Œæ‹–æ‹½å‚è€ƒçº¿ã€‚
>
> é¦–å…ˆï¼Œæ³¨æ„åˆ°ç”¨æˆ·æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªç±»ä¸­çš„å‡ ä¸ªæ–¹æ³•ï¼š`isPointOnRuler`, `canvasMouseDown`, `canvasMouseMove`, `canvasMouseUp`ï¼Œä»¥åŠä¸€ä¸ªè¾…åŠ©æ–¹æ³•`getCommonEventInfo`ã€‚è¿™äº›æ–¹æ³•å…±åŒå®ç°äº†åœ¨æ ‡å°ºä¸Šç‚¹å‡»ã€æ‹–æ‹½ç”Ÿæˆå‚è€ƒçº¿çš„åŠŸèƒ½ã€‚æˆ‘éœ€è¦æ‹†è§£æ¯ä¸ªæ–¹æ³•çš„èŒè´£ï¼Œç†æ¸…å®ƒä»¬ä¹‹é—´çš„åä½œå…³ç³»ã€‚
>
> ç¬¬ä¸€ä¸ªæ–¹æ³•æ˜¯`isPointOnRuler`ï¼Œå®ƒæ¥å—ä¸€ä¸ªç‚¹ï¼Œåˆ¤æ–­è¿™ä¸ªç‚¹æ˜¯å¦åœ¨å‚ç›´æˆ–æ°´å¹³æ ‡å°ºä¸Šã€‚è¿™é‡Œä½¿ç”¨`fabric.Rect`æ¥åˆ›å»ºä¸¤ä¸ªçŸ©å½¢åŒºåŸŸï¼Œåˆ†åˆ«ä»£è¡¨å‚ç›´å’Œæ°´å¹³æ ‡å°ºçš„ä½ç½®å’Œå¤§å°ï¼Œç„¶åä½¿ç”¨`containsPoint`æ£€æŸ¥ç‚¹æ˜¯å¦åœ¨å…¶ä¸­ã€‚ç”¨æˆ·å¯èƒ½å¯¹è¿™é‡Œä¸ºä»€ä¹ˆè¦æ–°å»ºçŸ©å½¢å¯¹è±¡æ„Ÿåˆ°ç–‘æƒ‘ï¼Œæˆ–è€…æ˜¯å¦æœ‰æ•ˆç‡é—®é¢˜ã€‚ä¸è¿‡Fabric.jsçš„`containsPoint`å¯èƒ½éœ€è¦å¯¹è±¡å®ä¾‹æ‰èƒ½è°ƒç”¨ï¼Œæ‰€ä»¥è™½ç„¶åˆ›å»ºä¸´æ—¶å¯¹è±¡å¯èƒ½æœ‰ç‚¹å¼€é”€ï¼Œä½†å¯èƒ½æ˜¯å¿…è¦çš„å®ç°æ–¹å¼ã€‚
>
> æ¥ä¸‹æ¥æ˜¯`canvasMouseDown`æ–¹æ³•ã€‚è¿™é‡Œå½“é¼ æ ‡æŒ‰ä¸‹æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥æ˜¯å¦åœ¨æ ‡å°ºä¸Šï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å¼€å§‹åˆ›å»ºå‚è€ƒçº¿ã€‚ç”¨æˆ·å¯èƒ½å¯¹`activeOn`çŠ¶æ€ç®¡ç†ä¸ç†è§£ï¼Œæ¯”å¦‚`activeOn`å¯èƒ½ç”¨æ¥è·Ÿè¸ªæ˜¯å¦å¤„äºæ‹–æ‹½çŠ¶æ€ã€‚åˆ›å»º`tempGuidelLine`å¹¶å°†å…¶æ·»åŠ åˆ°ç”»å¸ƒï¼Œç„¶åè®¾ç½®å®ƒä¸ºæ´»åŠ¨å¯¹è±¡ï¼Œè¿™é‡Œå¯èƒ½æ¶‰åŠFabric.jsçš„äº‹ä»¶å¤„ç†æœºåˆ¶ï¼Œæ¯”å¦‚`_setupCurrentTransform`å¯èƒ½ç”¨äºåˆå§‹åŒ–å˜æ¢æ“ä½œã€‚
>
> `getCommonEventInfo`æ–¹æ³•ç”Ÿæˆä¸€ä¸ªäº‹ä»¶ä¿¡æ¯å¯¹è±¡ï¼ŒåŒ…å«äº‹ä»¶æœ¬èº«ã€æŒ‡é’ˆä½ç½®ç­‰ï¼Œæ–¹ä¾¿åœ¨ä¸åŒäº‹ä»¶å¤„ç†å™¨ä¸­ä¼ é€’ã€‚ç”¨æˆ·å¯èƒ½å¯¹`transform`å±æ€§çš„è·å–æ–¹å¼æœ‰ç–‘é—®ï¼Œæˆ–è€…ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªç»“æ„ã€‚
>
> åœ¨`canvasMouseMove`ä¸­ï¼Œå¤„ç†é¼ æ ‡ç§»åŠ¨æ—¶çš„å‚è€ƒçº¿æ‹–æ‹½å’Œå…‰æ ‡æ ·å¼å˜åŒ–ã€‚å½“`tempGuidelLine`å­˜åœ¨æ—¶ï¼Œæ›´æ–°å…¶ä½ç½®ã€‚ç”¨æˆ·å¯èƒ½ä¼šç–‘æƒ‘`requestAnimationFrame`çš„ä½¿ç”¨ï¼Œç¡®ä¿æ¸²æŸ“çš„æµç•…æ€§ã€‚æ­¤å¤–ï¼Œå½“é¼ æ ‡åœ¨æ ‡å°ºä¸Šç§»åŠ¨æ—¶ï¼Œåˆ‡æ¢å…‰æ ‡æ ·å¼ï¼Œè¿™éƒ¨åˆ†å¯èƒ½éœ€è¦ç†è§£`lastAttr.status`çš„çŠ¶æ€ç®¡ç†ã€‚ä¾‹å¦‚ï¼Œå½“è¿›å…¥æ ‡å°ºåŒºåŸŸï¼Œå…‰æ ‡å˜ä¸ºè°ƒæ•´å¤§å°çš„æ ·å¼ï¼Œç¦»å¼€æ—¶æ¢å¤ã€‚
>
> `canvasMouseUp`åˆ™å¤„ç†é¼ æ ‡é‡Šæ”¾äº‹ä»¶ï¼Œæ¸…ç†çŠ¶æ€ï¼Œæ¢å¤ç”»å¸ƒçš„é€‰æ‹©åŠŸèƒ½ã€‚ç”¨æˆ·å¯èƒ½æƒ³çŸ¥é“ä¸ºä»€ä¹ˆéœ€è¦é‡ç½®`activeOn`å’Œ`tempGuidelLine`ï¼Œä»¥åŠ`fire('up')`äº‹ä»¶çš„ä½œç”¨ã€‚
>
> æ¥ä¸‹æ¥ï¼Œç”¨æˆ·å¯èƒ½çš„å›°æƒ‘ç‚¹åŒ…æ‹¬ï¼š
>
> 1. **Fabric.jsäº‹ä»¶å¤„ç†æœºåˆ¶**ï¼šæ¯”å¦‚`fire`æ–¹æ³•å’Œäº‹ä»¶ç›‘å¬çš„å…³ç³»ï¼Œå¦‚ä½•è§¦å‘è‡ªå®šä¹‰äº‹ä»¶ã€‚
>
> 2. **å‚è€ƒçº¿çš„åˆ›å»ºä¸æ‹–æ‹½é€»è¾‘**ï¼šå¦‚ä½•é€šè¿‡é¼ æ ‡äº‹ä»¶åŠ¨æ€ç”Ÿæˆå¹¶ç§»åŠ¨å‚è€ƒçº¿ã€‚
>
> 3. **çŠ¶æ€ç®¡ç†å˜é‡**ï¼šå¦‚`activeOn`, `lastAttr`, `tempGuidelLine`çš„ä½œç”¨å’Œå˜åŒ–è¿‡ç¨‹ã€‚
>
> 4. **Fabric.jså¯¹è±¡çš„æ–¹æ³•ä½¿ç”¨**ï¼šå¦‚`_setupCurrentTransform`çš„ä½œç”¨ï¼Œæ˜¯å¦æ˜¯Fabric.jså†…éƒ¨APIï¼Œä½¿ç”¨æ˜¯å¦å®‰å…¨ã€‚
>
> 5. **ä¸´æ—¶å¯¹è±¡çš„åˆ›å»º**ï¼šåœ¨`isPointOnRuler`ä¸­æ¯æ¬¡è°ƒç”¨éƒ½åˆ›å»ºæ–°çš„`fabric.Rect`æ˜¯å¦ä¼šæœ‰æ€§èƒ½é—®é¢˜ï¼Œæˆ–è€…æ˜¯å¦æœ‰æ›´å¥½çš„æ–¹æ³•ã€‚
>
> 6. **åæ ‡ç³»çš„å¤„ç†**ï¼š`pointer`å’Œ`absolutePointer`çš„åŒºåˆ«ï¼Œä¸ºä½•åœ¨`canvasMouseDown`ä¸­åŒæ—¶ä½¿ç”¨äº†è¿™ä¸¤ä¸ªã€‚
>
> 7. **å…‰æ ‡æ ·å¼çš„åˆ‡æ¢é€»è¾‘**ï¼šå¦‚ä½•æ ¹æ®æ ‡å°ºçš„ä½ç½®åˆ‡æ¢å…‰æ ‡ï¼Œ`lastAttr.status`è·Ÿè¸ªçš„çŠ¶æ€å˜åŒ–ã€‚
>
> 8. **äº‹ä»¶ä¿¡æ¯å¯¹è±¡çš„ç»“æ„**ï¼š`getCommonEventInfo`çš„ä½œç”¨æ˜¯å¦ä¸ºäº†ç»Ÿä¸€äº‹ä»¶å‚æ•°ï¼Œæ–¹ä¾¿åœ¨å¤šä¸ªäº‹ä»¶ä¸­å¤ç”¨ã€‚
>
> è¿˜éœ€è¦è€ƒè™‘ä»£ç çš„ç»“æ„å’Œå¯èƒ½çš„ä¼˜åŒ–ç‚¹ã€‚ä¾‹å¦‚ï¼Œ`isPointOnRuler`ä¸­çš„çŸ©å½¢æ˜¯å¦å¯ä»¥é¢„å…ˆåˆ›å»ºè€Œéæ¯æ¬¡åˆ¤æ–­æ—¶æ–°å»ºï¼Œæˆ–è€…æ£€æŸ¥ç‚¹æ˜¯å¦åœ¨æ ‡å°ºåŒºåŸŸçš„æ›´é«˜æ•ˆæ–¹æ³•ã€‚æ­¤å¤–ï¼Œ`_setupCurrentTransform`å¯èƒ½æ˜¯ä¸€ä¸ªå†…éƒ¨æ–¹æ³•ï¼Œç›´æ¥ä½¿ç”¨æ˜¯å¦å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ã€‚
>
> åœ¨è§£é‡Šè¿‡ç¨‹ä¸­ï¼Œéœ€è¦é€æ­¥æ‹†è§£æ¯ä¸ªæ–¹æ³•çš„é€»è¾‘ï¼Œè§£é‡Šå„ä¸ªå˜é‡çš„ç”¨é€”ï¼Œå¹¶è¯´æ˜äº‹ä»¶å¤„ç†çš„æµç¨‹ï¼Œä»é¼ æ ‡æŒ‰ä¸‹ã€ç§»åŠ¨ã€åˆ°é‡Šæ”¾çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸã€‚åŒæ—¶ï¼Œç»“åˆFabric.jsçš„çŸ¥è¯†ï¼Œè¯´æ˜ä¸ºä»€ä¹ˆæŸäº›æ–¹æ³•éœ€è¦è¿™æ ·è°ƒç”¨ï¼Œæ¯”å¦‚æ·»åŠ å‚è€ƒçº¿åˆ°ç”»å¸ƒï¼Œè®¾ç½®æ´»åŠ¨å¯¹è±¡ç­‰å¦‚ä½•å½±å“ç”»å¸ƒçš„äº¤äº’ã€‚
>
> å¦å¤–ï¼Œç”¨æˆ·å¯èƒ½å¯¹æŸäº›ä»£ç è¡Œå­˜åœ¨ç–‘é—®ï¼Œä¾‹å¦‚`this.options.canvas._setupCurrentTransform(e.e, this.tempGuidelLine, true);`ä¸­çš„ç¬¬ä¸‰ä¸ªå‚æ•°`true`çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Œæˆ–æ˜¯`fire`æ–¹æ³•è§¦å‘çš„è‡ªå®šä¹‰äº‹ä»¶åœ¨å…¶ä»–åœ°æ–¹å¦‚ä½•å¤„ç†ã€‚
>
> æœ€åï¼Œéœ€è¦æ€»ç»“æ•´ä¸ªä»£ç çš„åŠŸèƒ½ï¼Œå°†å„ä¸ªéƒ¨åˆ†ä¸²è”èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„æµç¨‹ï¼šç”¨æˆ·ç‚¹å‡»æ ‡å°ºåŒºåŸŸï¼Œåˆ›å»ºå‚è€ƒçº¿ï¼Œæ‹–æ‹½ç§»åŠ¨ï¼Œé‡Šæ”¾é¼ æ ‡åå®Œæˆæ“ä½œã€‚è¿™ä¸€è¿‡ç¨‹ä¸­æ¶‰åŠåˆ°Fabric.jsçš„äº‹ä»¶å¤„ç†ã€å¯¹è±¡æ·»åŠ ä¸å˜æ¢ã€çŠ¶æ€ç®¡ç†ç­‰å…³é”®ç‚¹ã€‚
>
> 



ä»¥ä¸‹æ˜¯å¯¹è¿™æ®µä»£ç çš„è¯¦ç»†åˆ†æ­¥è§£æï¼Œå¸®åŠ©ä½ å…¨é¢ç†è§£å…¶é€»è¾‘ï¼š

---

### **1. ä»£ç æ•´ä½“åŠŸèƒ½**
è¿™æ˜¯ä¸€ä¸ª **æ ‡å°ºæ’ä»¶ï¼ˆFabric.js Ruler Pluginï¼‰** çš„æ ¸å¿ƒäº¤äº’éƒ¨åˆ†ï¼Œæ”¯æŒä»¥ä¸‹åŠŸèƒ½ï¼š
- åˆ¤æ–­é¼ æ ‡æ˜¯å¦æ‚¬åœåœ¨å‚ç›´æˆ–æ°´å¹³æ ‡å°ºä¸Š
- åœ¨æ ‡å°ºä¸Šç‚¹å‡»æ‹–æ‹½ç”Ÿæˆå¯ç§»åŠ¨çš„å‚è€ƒçº¿ï¼ˆGuideLineï¼‰
- åŠ¨æ€æ›´æ–°å‚è€ƒçº¿ä½ç½®
- è‡ªåŠ¨åˆ‡æ¢æŒ‡é’ˆæ ·å¼ï¼ˆå·¦å³/ä¸Šä¸‹ç®­å¤´ï¼‰

---

### **2. å…³é”®å˜é‡è¯´æ˜**
| å˜é‡å              | ç±»å‹/ä½œç”¨                                                                 |
|---------------------|-------------------------------------------------------------------------|
| `tempGuidelLine`     | ä¸´æ—¶å‚è€ƒçº¿å¯¹è±¡ï¼Œåœ¨æ‹–æ‹½ä¸­æš‚å­˜                                             |
| `activeOn`           | å½“å‰æ¿€æ´»çŠ¶æ€ï¼ˆ`'up'`æœªæ¿€æ´»/`'down'`æŒ‰ä¸‹çŠ¶æ€ï¼‰ï¼Œç”¨äºé˜»æ­¢é‡å¤è§¦å‘           |
| `lastAttr`           | è®°å½•ç”»å¸ƒåŸæœ‰çŠ¶æ€çš„å®¹å™¨ï¼ˆå¦‚å…‰æ ‡æ ·å¼ã€é€‰æ‹©æ¨¡å¼ï¼‰                           |
| `options.ruleSize`   | æ ‡å°ºå®½åº¦/é«˜åº¦ï¼ˆé€šè¿‡å‚æ•°ä¼ å…¥ï¼Œå¦‚é»˜è®¤ `20px`ï¼‰                             |

---

### **3. æ–¹æ³•é€è¡Œè§£æ**

#### **(1) **`isPointOnRuler(point: Point)`
**ä½œç”¨**ï¼šåˆ¤æ–­é¼ æ ‡æŒ‡é’ˆæ˜¯å¦åœ¨æ ‡å°ºåŒºåŸŸå†…ã€‚
```typescript
public isPointOnRuler(point: Point) {
  // åˆ›å»ºå‚ç›´æ ‡å°ºæ£€æµ‹åŒºåŸŸï¼ˆå·¦è¾¹æ ‡å°ºï¼‰
  const verticalRuler = new fabric.Rect({
    left: 0,
    top: 0,
    width: this.options.ruleSize,   // æ ‡å°ºå®½åº¦
    height: this.options.canvas.height // è¦†ç›–æ•´ä¸ªç”»å¸ƒé«˜åº¦
  });
  if (verticalRuler.containsPoint(point)) return 'vertical';

  // åˆ›å»ºæ°´å¹³æ ‡å°ºæ£€æµ‹åŒºåŸŸï¼ˆé¡¶éƒ¨æ ‡å°ºï¼‰
  const horizontalRuler = new fabric.Rect({
    left: 0,
    top: 0,
    width: this.options.canvas.width, // è¦†ç›–æ•´ä¸ªç”»å¸ƒå®½åº¦
    height: this.options.ruleSize     // æ ‡å°ºé«˜åº¦
  });
  if (horizontalRuler.containsPoint(point)) return 'horizontal';

  return false; // ä¸åœ¨æ ‡å°ºåŒºåŸŸ
}
```
**å…³é”®ç‚¹**ï¼š
- åˆ©ç”¨ä¸´æ—¶ `fabric.Rect` å¯¹è±¡é€šè¿‡å‡ ä½•æ£€æµ‹ (`containsPoint`) åˆ¤æ–­åæ ‡ç‚¹ä½ç½®ã€‚
- **æ€§èƒ½ä¼˜åŒ–**ï¼šç”±äºåªæ£€æµ‹ä¸¤ä¸ªå›ºå®šåŒºåŸŸï¼Œæ— éœ€é«˜é¢‘è°ƒç”¨ï¼Œä¸´æ—¶çŸ©å½¢å¯¹è±¡ä¸ä¼šäº§ç”Ÿæ˜æ˜¾æ€§èƒ½æŸè€—ã€‚

---

#### **(2) **`canvasMouseDown(e)`
**ä½œç”¨**ï¼šå¤„ç†æ ‡å°ºåŒºåŸŸçš„é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶ï¼ˆå¼€å§‹æ‹–æ‹½å‚è€ƒçº¿ï¼‰ã€‚
```typescript
private canvasMouseDown(e: IEvent<MouseEvent>) {
  if (!e.pointer || !e.absolutePointer) return;

  // æ£€æŸ¥æ˜¯å¦åœ¨æ ‡å°ºä¸Š
  const hoveredRuler = this.isPointOnRuler(e.pointer);
  if (hoveredRuler && this.activeOn === 'up') {

    // å¤‡ä»½ç”»å¸ƒåŸæœ‰æ˜¯å¦å…è®¸æ¡†é€‰çš„å±æ€§
    this.lastAttr.selection = this.options.canvas.selection;
    this.options.canvas.selection = false; // æ‹–æ‹½å‚è€ƒçº¿æ—¶ç¦ç”¨ç”»å¸ƒæ¡†é€‰

    this.activeOn = 'down';  // æ ‡è®°ä¸ºæŒ‰ä¸‹çŠ¶æ€
    
    // åˆ›å»ºå‚è€ƒçº¿å®ä¾‹
    this.tempGuidelLine = new fabric.GuideLine(
      hoveredRuler === 'horizontal' ? e.absolutePointer.y : e.absolutePointer.x, // åˆå§‹ä½ç½®ï¼ˆé€»è¾‘åæ ‡ï¼‰
      { 
        axis: hoveredRuler, // æ–¹å‘
        visible: false      // åˆå§‹éšè—ï¼ˆé˜²æ­¢é—ªçƒï¼‰
      }
    );

    // æ·»åŠ åˆ°ç”»å¸ƒå¹¶æ¿€æ´»
    this.options.canvas.add(this.tempGuidelLine);
    this.options.canvas.setActiveObject(this.tempGuidelLine);

    // åˆå§‹åŒ–å¯¹è±¡å˜æ¢æ“ä½œï¼ˆFabric.jså†…éƒ¨æ–¹æ³•ï¼‰
    this.options.canvas._setupCurrentTransform(e.e, this.tempGuidelLine, true);

    // è§¦å‘å‚è€ƒçº¿å¯¹è±¡çš„ 'down' äº‹ä»¶
    this.tempGuidelLine.fire('down', this.getCommonEventInfo(e));
  }
}
```
**å…³é”®ç‚¹**ï¼š
- **`e.pointer`**ï¼šç”»å¸ƒåæ ‡ç³»ä¸­çš„åæ ‡ï¼ˆç›¸å¯¹äºç”»å¸ƒå·¦ä¸Šè§’ï¼‰ã€‚
- **`e.absolutePointer`**ï¼šå±å¹•åæ ‡ç³»ä¸­çš„åæ ‡ï¼ˆç›¸å¯¹äºæµè§ˆå™¨çª—å£ï¼‰ã€‚
- `_setupCurrentTransform`: å†…éƒ¨æ–¹æ³•ï¼Œåˆå§‹åŒ–å¯¹è±¡çš„æ‹–åŠ¨å˜æ¢æ§åˆ¶ï¼ˆéœ€ä¼ é€’é¼ æ ‡äº‹ä»¶å¯¹è±¡ `e.e`ï¼‰ã€‚
- `fire('down')`: è§¦å‘è‡ªå®šä¹‰äº‹ä»¶ï¼Œç±»ä¼¼åŸç”Ÿ Fabric.js äº‹ä»¶ï¼ˆå¦‚ `object:selected`ï¼‰ã€‚

---

#### **(3) **`canvasMouseMove(e)`
**ä½œç”¨**ï¼šå¤„ç†é¼ æ ‡ç§»åŠ¨æ—¶çš„å‚è€ƒçº¿æ‹–æ‹½å’Œå…‰æ ‡æ ·å¼æ›´æ–°ã€‚
```typescript
private canvasMouseMove(e: IEvent<MouseEvent>) {
  if (!e.pointer) return;

  // å¤„ç†å‚è€ƒçº¿æ‹–åŠ¨
  if (this.tempGuidelLine && e.absolutePointer) {
    const pos: Partial<fabric.IGuideLineOptions> = {};

    // æ ¹æ®å‚è€ƒçº¿æ–¹å‘æ›´æ–°ä½ç½®ï¼ˆé™é»˜æ›´æ–°ï¼Œéœ€æ‰‹åŠ¨åˆ·æ–°ç”»å¸ƒï¼‰
    if (this.tempGuidelLine.axis === 'horizontal') {
      pos.top = e.absolutePointer.y; // ç»å¯¹Yåæ ‡ï¼ˆå¯¹åº”æ°´å¹³å‚è€ƒçº¿ï¼‰
    } else {
      pos.left = e.absolutePointer.x; // ç»å¯¹Xåæ ‡ï¼ˆå¯¹åº”å‚ç›´å‚è€ƒçº¿ï¼‰
    }

    this.tempGuidelLine.set({ ...pos, visible: true }); // æ˜¾ç¤ºå‚è€ƒçº¿

    // è¯·æ±‚ä¸‹ä¸€æ¬¡å±å¹•æ¸²æŸ“ï¼ˆä¼˜åŒ–æ€§èƒ½ï¼‰
    requestAnimationFrame(() => this.options.canvas.requestRenderAll());

    // è§¦å‘ Fabric.js çš„ object:moving äº‹ä»¶
    const event = this.getCommonEventInfo(e);
    this.options.canvas.fire('object:moving', event);
    this.tempGuidelLine.fire('moving', event);
  }

  // æ›´æ–°å…‰æ ‡æ ·å¼
  const hoveredRuler = this.isPointOnRuler(e.pointer);
  if (!hoveredRuler) {
    if (this.lastAttr.status !== 'out') { // å…‰æ ‡ç¦»å¼€æ ‡å°ºåŒºåŸŸ
      this.options.canvas.defaultCursor = this.lastAttr.cursor; // æ¢å¤é»˜è®¤å…‰æ ‡
      this.lastAttr.status = 'out';
    }
    return;
  }

  // æ ¹æ®æ‚¬åœæ–¹å‘åˆ‡æ¢å…‰æ ‡æ ·å¼
  if (this.lastAttr.status === 'out' || hoveredRuler !== this.lastAttr.status) {
    this.lastAttr.cursor = this.options.canvas.defaultCursor; // ä¿å­˜åŸæ ·å¼
    this.options.canvas.defaultCursor = hoveredRuler === 'horizontal' 
      ? 'ns-resize' // ä¸Šä¸‹ç®­å¤´ï¼ˆæ°´å¹³å‚è€ƒçº¿ï¼‰
      : 'ew-resize'; // å·¦å³ç®­å¤´ï¼ˆå‚ç›´å‚è€ƒçº¿ï¼‰
    this.lastAttr.status = hoveredRuler;
  }
}
```
**å…³é”®ç‚¹**ï¼š
- **æ¡ä»¶åˆ†æ”¯**ï¼šä¼˜å…ˆå¤„ç†å‚è€ƒçº¿æ‹–æ‹½ï¼Œè‹¥æ— æ‹–æ‹½åˆ™å¤„ç†å…‰æ ‡æ ·å¼ã€‚
- **`ns-resize` / `ew-resize`**: CSS æ ‡å‡†å…‰æ ‡åç§°ï¼Œå¯¹åº”å‚ç›´/æ°´å¹³æ‹–æ‹½æ ·å¼ã€‚
- **`requestAnimationFrame`**ï¼šç¡®ä¿åœ¨é«˜é¢‘è§¦å‘ `mousemove` æ—¶ä¸å¡é¡¿ã€‚

---

#### **(4) **`canvasMouseUp(e)`
**ä½œç”¨**ï¼šå¤„ç†é¼ æ ‡é‡Šæ”¾äº‹ä»¶ï¼Œå®Œæˆå‚è€ƒçº¿æ”¾ç½®ã€‚
```typescript
private canvasMouseUp(e: IEvent<MouseEvent>) {
  if (this.activeOn !== 'down') return; // æœªæ¿€æ´»æ—¶ä¸å¤„ç†

  // æ¢å¤ç”»å¸ƒåˆå§‹é…ç½®
  this.options.canvas.selection = this.lastAttr.selection;
  this.activeOn = 'up';

  // è§¦å‘å‚è€ƒçº¿å¯¹è±¡çš„ 'up' äº‹ä»¶ï¼ˆå¯åœ¨æ­¤ä¿å­˜å‚è€ƒçº¿ä½ç½®ï¼‰
  this.tempGuidelLine?.fire('up', this.getCommonEventInfo(e));

  // æ¸…é™¤ä¸´æ—¶å‚è€ƒçº¿
  this.tempGuidelLine = undefined;
}
```

---

#### **(5) **`getCommonEventInfo(e)`
**è¾…åŠ©æ–¹æ³•**ï¼šæ„å»ºç»Ÿä¸€çš„äº‹ä»¶å‚æ•°å¯¹è±¡ã€‚
```typescript
private getCommonEventInfo = (e: IEvent<MouseEvent>) => {
  if (!this.tempGuidelLine || !e.absolutePointer) return;

  return {
    e: e.e, // åŸç”Ÿé¼ æ ‡äº‹ä»¶å¯¹è±¡
    transform: this.tempGuidelLine.get('transform'), // å‚è€ƒçº¿çš„å˜æ¢çŠ¶æ€
    pointer: { // é€»è¾‘åæ ‡ç³»åæ ‡
      x: e.absolutePointer.x,
      y: e.absolutePointer.y
    },
    target: this.tempGuidelLine // å½“å‰æ“ä½œçš„å‚è€ƒçº¿
  };
};
```

---

### **4. å…¨æµç¨‹æ€»ç»“**
1. **é¼ æ ‡æŒ‰ä¸‹**ï¼ˆæ ‡å°ºåŒºåŸŸï¼‰ï¼š
   - åˆ›å»ºéšè—å‚è€ƒçº¿
   - ç¦ç”¨ç”»å¸ƒæ¡†é€‰
   - åˆå§‹åŒ–ä¸ºæ‹–æ‹½çŠ¶æ€

2. **é¼ æ ‡ç§»åŠ¨**ï¼š
   - æ›´æ–°å‚è€ƒçº¿ä½ç½®ï¼ˆè·ŸéšæŒ‡é’ˆï¼‰
   - åŒæ­¥è§¦å‘ç§»åŠ¨äº‹ä»¶ï¼ˆä¾›å…¶ä»–é€»è¾‘è®¢é˜…ï¼‰
   - åŠ¨æ€åˆ‡æ¢å…‰æ ‡æ ·å¼

3. **é¼ æ ‡é‡Šæ”¾**ï¼š
   - æ¢å¤ç”»å¸ƒåˆå§‹è®¾ç½®
   - æ¸…é™¤ä¸´æ—¶å‚è€ƒçº¿
   - è§¦å‘ç»“æŸäº‹ä»¶

---

### **5. å¯èƒ½çš„é—®é¢˜è§£ç­”**
#### **Q1: `_setupCurrentTransform` æ˜¯å®‰å…¨æ“ä½œå—ï¼Ÿ**
- è¿™æ˜¯ Fabric.js çš„ **å†…éƒ¨æ–¹æ³•**ï¼Œç”¨äºåˆå§‹åŒ–å¯¹è±¡å˜æ¢ï¼ˆæ‹–åŠ¨/æ—‹è½¬ç­‰ï¼‰ã€‚
- å­˜åœ¨ç‰ˆæœ¬ä¸å…¼å®¹é£é™©ï¼Œå»ºè®®åœ¨æ’ä»¶ä»£ç ä¸­æµ‹è¯•ä¸»ç‰ˆæœ¬å·ã€‚
- æ›¿ä»£æ–¹æ¡ˆï¼šç›´æ¥è°ƒç”¨ `this.tempGuidelLine.setPositionByOrigin()` æ‰‹åŠ¨æ§åˆ¶ä½ç½®ã€‚

#### **Q2: ä¸ºä½•ä½¿ç”¨ `absolutePointer` è€Œé `pointer`ï¼Ÿ**
- `pointer`ï¼šç”»å¸ƒå†…ç›¸å¯¹åæ ‡ï¼ˆåŸç‚¹ä¸ºç”»å¸ƒå·¦ä¸Šè§’ï¼Œè€ƒè™‘è§†å£å˜æ¢ï¼‰ã€‚
- `absolutePointer`ï¼šå…¨å±€ç»å¯¹åæ ‡ï¼ˆåŸç‚¹ä¸ºé¡µé¢å·¦ä¸Šè§’ï¼Œä¸å—ç¼©æ”¾ä½ç§»å½±å“ï¼‰ã€‚
- ç›´æ¥ä½¿ç”¨ `absolutePointer` æ›´é€‚åˆæ ‡å°ºå‚è€ƒçº¿çš„å±å¹•æ˜ å°„ã€‚

#### **Q3: å¦‚ä½•é˜²æ­¢é«˜é¢‘æ¸²æŸ“å¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Ÿ**
- `requestAnimationFrame` åˆå¹¶å¤šæ¬¡ `renderAll` è°ƒç”¨ï¼Œç¡®ä¿æ¯å¸§åªæ¸²æŸ“ä¸€æ¬¡ã€‚
- é¿å…åœ¨ `mousemove` ä¸­é¢‘ç¹åˆ›å»º/é”€æ¯å¯¹è±¡ã€‚
