![alt text](image.png)
性能指标的采集以及上报
指标的分解
指标采集，sdk封装
统计埋点，上报策略，数据预处理
主要内容是吧前面提到的性能指标以代码的形式分解落地，确保可以采集，然后在SDK封装后集合统计埋点，最后根据实际情况，制定上报策略
当指标超过某一监控阈值的时候，性能监控预警平台通过邮件或者短信的方式给我们发送预警消息，性能数据处理后台和性能可视化展现前台两个部分
# 性能优化关键指标的设定以及标准
视觉稳定性指标
CLS(Cumulative Layout shift)
也就是布局偏移量，它是指页面从一帧切换到另外一帧的时候，视线当中不稳定元素的偏移情况
### 交互方面
有的公司用FID指标(First Input Delay)首次输入延迟，指标必须要小于100ms
有的公司使用PSI（perceptual speed index）视觉变化率，衡量的标准为小于20%;
### 首屏时间如何计算的？
首屏时间=白屏时间+渲染时间
从浏览器输入地址回车开始，到首屏内容渲染完毕的时间，
这期间不需要滚动鼠标或者下拉页面，否则无效的
![alt text](image-1.png)
秒开率指标：
就是1s打开用户的占比
# 业务目标和用户冲突的处理
首屏时间毕竟粒度太粗了，
如果首屏时间长但是白屏时间短，到底是哪里出现了问题？
首屏时间可以拆分成白屏时间，数据接口响应时间，图片加载资源等等
白屏时间数据接口响应时间可以直接从后端服务当中获取，不需要前端再重复计算的
# 页面加载大致过程是怎么样的/
客户端发起请求的阶段
服务器端数据处理请求阶段
客户端页面渲染阶段
## 客户端请求阶段的瓶颈点
客户端发起请求阶段是指的是用户在浏览器输入URL，经过本地缓存确认是否已经存在这个网站了
如果没有，接着会由DNS查询从域名服务器获取这个IP地址，
接下来是客户端通过TCP三次握手，和TLS协商向服务器端发起http请求建立链接的过程
### DNS查询
节省时间的办法是让dns查询走缓存
幸好浏览器提供了dns预获取的接口
我们可以在打开浏览器或者webview的同时就进行配置
### 浏览器同域名的链接限制数目是多少个？
一般是6个，如果当请求数目多于6个，只能6个并发，其余的得要等到最后先返回的请求后，才能做下一次的请求
# 域名规划很重要
我们可以先看看当前页面需要用到哪些域名，最关键的是首屏当中需要用到哪些域名
# 数据缓存
借助service worker的数据接口缓存数据，借助本地存储的接口缓存数据，CDN
