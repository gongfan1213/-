### 实体关系（ER）模型（第2部分）
#### 回顾
- **实体和属性**
    - 公寓门牌号
    - 街道门牌号、街道名称、中间名、姓氏、名字
    - 身份证号码（HKID）
    - 城市、姓名、地址、州、邮政编码
    - 电话号码、出生日期、年龄
    - 多值属性
    - 派生属性
#### 大纲
- 关系集
- 关系集上的约束：一对一（1 - 1）、一对多（1 - m）、多对一（m - 1）、多对多（m - m）
#### ER中的“R”：关系
- 关系描述了实体之间的联系。
- 关系示例：
    - 一个人拥有一只宠物。
    - 一个人购买了一张CD。
    - 一个人居住在某个地址。
#### 什么是关系？
- 对于每一个唯一的实体组合，只能存在一种关系。这意味着关系由其相关实体的键唯一确定。
- 示例：“拥有”关系的键是{Person.HKID, Pet.ID}。
| HKID | 姓名 | 地区 |
| --- | --- | --- |
| 爱丽丝 | R133428(6) | 九龙 |
| 鲍勃 | P625228(4) | 香港 |
| 坎迪 | A252242(7) | 新界 |
| ID | 姓名 |
| --- | --- |
| 1 | 山姆 |
| 2 | 莱迪 |
| 3 | 贝尔 |
#### 关系集
- 关系集用于捕获相同“类型”的关系。
- 每个连接都是一种关系，所有连接的集合构成一个关系集。
#### 具有属性的关系
| HKID | ID | 姓名 | 姓名 | 地址 |
| --- | --- | --- | --- | --- |
|  |  |  |  |  |
#### 问题1
1. 根据以下信息绘制计算机科学（CS）数据库的ER图：
    - 学生应有学生ID（std - id）和姓名。
    - 课程应有课程代码（class - code）和课程名称。
    - 教授应有教授ID（prof - id）和姓名。
    - 学生可以注册多门课程。
    - 一门课程可以被多名学生注册。
    - 一门课程在特定时间和地点最多由一位教授授课（即不允许联合授课）。
    - 一位教授可以教授多门课程。
#### 关系集上的约束
- 在上述示例中：一门课程最多由一位教授授课，而一位教授可以教授多门课程。
- 这是一个一对多约束的例子。我们可以用一个箭头（一端指向“一”，另一端指向“多”）来表示它。
| 课程代码 | 教授ID | 姓名 | 姓名 |
| --- | --- | --- | --- |
|  |  |  |  |
#### 关系集上的约束
- 每个关系集都与两种约束相关联：
    - 基数约束
    - 参与约束
- 这些约束为对现实世界的联系进行建模提供了有力的方法。
#### 基数约束
- 基数约束应用于关系集。
- 基数约束有四种类型：一对一、一对多、多对一、多对多。
#### 基数约束
| 一对一（例如，夫妻关系） | 一对多（例如，学生 - 书籍关系） |
| --- | --- |
|  |  |
#### 一对一关系的表示
- 一位客户最多可以借一笔贷款（0笔或1笔）。
- 一笔贷款最多可以被一位客户借用。
| 客户姓名 | 客户街道 | 贷款编号 | 金额 |
| --- | --- | --- | --- |
|  |  |  |  |
#### 一对多关系的表示
- 一位客户可以借多笔贷款（0笔或更多）。
- 一笔贷款最多可以被一位客户借用。
| 客户姓名 | 客户街道 | 贷款编号 | 金额 |
| --- | --- | --- | --- |
|  |  |  |  |
#### 基数约束
| 多对一（例如，孩子 - 父亲关系） | 多对多（例如，朋友关系） |
| --- | --- |
|  |  |
#### 多对一关系的表示
- 一位客户最多可以借一笔贷款。
- 一笔贷款可以被多位客户共享。
| 客户姓名 | 客户街道 | 贷款编号 | 金额 |
| --- | --- | --- | --- |
|  |  |  |  |
#### 多对多关系的表示
- 一位客户可以借多笔贷款。
- 一笔贷款可以被多位客户共享。
| 客户姓名 | 客户街道 | 贷款编号 | 金额 |
| --- | --- | --- | --- |
|  |  |  |  |
#### 问题2
2. 根据以下信息绘制图书馆数据库的ER图：
    - 每位用户都有用户ID（user - id）、姓名和地址。
    - 每本书都有书ID（book - id）、书名（book - name）和出版商名称（publisher - name）。
    - 每位作者都有作者ID（author - id）和姓名。
    - 每位用户可以借阅多本书。
    - 每本书最多只能被一位用户借阅。
    - 每本书可以由多位作者撰写。
    - 每位作者可以撰写多本书。
#### 问题3
用以下条件重复问题2：
- 每位用户最多只能借阅一本书。
- 每本书最多只能被一位用户借阅。
- 每本书最多只能由一位作者撰写。
- 每位作者可以撰写多本书。
#### 参与约束
- 在前面一对一基数约束的例子中，一个男人/女人最多只能与一个女人/男人结婚（但这个男人/女人也可以未婚）。
- 当我们允许“夫妻”关系中有未婚的人时，这被称为部分参与（否则为完全参与）。
#### 参与约束
- 完全参与：实体集中的每个实体都必须至少参与一个关系。
- 部分参与：部分实体可能不参与。
- 在ER图中，参与约束用粗线表示。
#### 参与约束
从这个关系中的参与约束可以推断出什么？
| 客户姓名 | 客户街道 | 贷款编号 |
| --- | --- | --- |
|  |  |  |
| 示例： |  |  |
| 每位客户必须至少借一笔贷款。 |  |  |
| 有些贷款可能没有被任何客户借阅。 |  |  |
#### 更多关于约束的内容
- 基数约束：1 - 1、1 - m、m - 1、m - m
- 参与约束：部分参与、完全参与
- 这两种类型的约束是相互独立的。每种基数约束都可以与任何参与约束一起使用。
#### 更多关于约束的内容
在以下关系中你能推断出什么？
| 客户姓名 | 客户街道 | 贷款编号 | 金额 |
| --- | --- | --- | --- |
|  |  |  |  |
- 一位客户最多可以借一笔贷款。
- 一笔贷款最多可以被一位客户借用。
- 每笔贷款都必须被借出。
#### 更多关于约束的内容
在以下关系中你能推断出什么？
| 客户姓名 | 客户街道 | 贷款编号 | 金额 |
| --- | --- | --- | --- |
|  |  |  |  |
- 一位客户可以借多笔贷款。
- 一笔贷款最多可以被一位客户借用。
- 每笔贷款都必须被借出。
#### 更多关于约束的内容
在以下关系中你能推断出什么？
| 客户姓名 | 客户街道 | 贷款编号 | 金额 |
| --- | --- | --- | --- |
|  |  |  |  |
- 一笔贷款可以被多位客户借用。
- 一位客户最多可以借一笔贷款。
- 每笔贷款都必须被借出。
#### 更多关于约束的内容
在以下关系中你能推断出什么？
| 客户姓名 | 客户街道 | 贷款编号 | 金额 |
| --- | --- | --- | --- |
|  |  |  |  |
- 一位客户可以借多笔贷款。
- 一笔贷款最多可以被一位客户借用。
- 每位客户都必须借一些贷款。
#### 问题4
用以下条件重复问题1：
- 学生可能不注册任何课程。
- 一门课程必须至少有20名学生。
- 教授可能不教授任何课程。
- 一门课程必须最多由一位教授授课。
#### 问题5
用以下条件重复问题2：
- 每位用户可能不借阅任何书籍。
- 每本书可能不被任何用户借阅，或者最多被一位用户借阅。
- 每本书必须至少由一位作者撰写。
- 每位作者必须至少撰写一本书。
#### 问题6
在一所大学中，教授有员工ID（sid）、姓名和所在系。每位教授可以雇佣多名研究助理。每位研究助理有员工ID（rid）、姓名和资助项目ID（pid）。每位研究助理必须由一位教授雇佣。绘制ER图来对教授和研究助理之间的关系进行建模。
#### 问题7
在以下关系中你能推断出什么？
| 客户姓名 | 客户街道 | 贷款编号 | 金额 |
| --- | --- | --- | --- |
|  |  |  |  |
#### 关于ER图我们学到了什么？
- 实体集
- 属性
- 关系集
- 一对一、一对多、多对一、多对多
- 完全/部分参与
- 属性
#### 问题1的答案
| 课程代码 | 时间 | 教授ID | 姓名 | 姓名 |
| --- | --- | --- | --- | --- |
|  |  |  |  |  |
#### 问题2的答案
| 书名 | 书ID | 地址 | 用户ID | 姓名 | 出版商名称 |
| --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |
#### 问题3的答案
| 书名 | 书ID | 地址 | 用户ID | 姓名 | 出版商名称 |
| --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |
#### 问题4的答案
| 课程代码 | 时间 | 教授ID | 姓名 | 姓名 |
| --- | --- | --- | --- | --- |
|  |  |  |  |  |
#### 问题5的答案
| 书名 | 书ID | 地址 | 用户ID | 姓名 | 出版商名称 |
| --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |
#### 问题6的答案
| rid | 姓名 | 系 | pid | sid | 姓名 |
| --- | --- | --- | --- | --- | --- |
|  |  |  |  |  |  |
#### 问题7的答案
- 每位客户应该恰好借一笔贷款。
- 每笔贷款应该恰好被一位客户借用。
| 客户姓名 | 客户街道 | 贷款编号 | 金额 |
| --- | --- | --- | --- |
|  |  |  |  | 
